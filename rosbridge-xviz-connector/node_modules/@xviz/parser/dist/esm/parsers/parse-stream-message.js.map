{"version":3,"sources":["../../../src/parsers/parse-stream-message.js"],"names":["parseStreamDataMessage","postDeserialize","getWorkerFarm","initializeWorkerFarm","initializeWorkers","worker","maxConcurrency","parseStreamMessage","message","onResult","onError","debug","workerFarm","onMessage","data","process"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,SAAQA,sBAAR,QAAqC,6BAArC;AACA,SAAQC,eAAR,QAA8B,aAA9B;AACA,SAAQC,aAAR,EAAuBC,oBAAvB,QAAkD,2BAAlD,C,CAEA;;AACA,OAAO,SAASC,iBAAT,OAAyD;AAAA,MAA7BC,MAA6B,QAA7BA,MAA6B;AAAA,iCAArBC,cAAqB;AAAA,MAArBA,cAAqB,oCAAJ,CAAI;AAC9DH,EAAAA,oBAAoB,CAAC;AAACE,IAAAA,MAAM,EAANA,MAAD;AAASC,IAAAA,cAAc,EAAdA;AAAT,GAAD,CAApB;AACD;AAED,OAAO,SAASC,kBAAT,QASJ;AAAA,MARDC,OAQC,SARDA,OAQC;AAAA,MANDC,QAMC,SANDA,QAMC;AAAA,MALDC,OAKC,SALDA,OAKC;AAAA,MAJDC,KAIC,SAJDA,KAIC;AAAA,2BAFDN,MAEC;AAAA,MAFDA,MAEC,6BAFQ,KAER;AAAA,mCADDC,cACC;AAAA,MADDA,cACC,qCADgB,CAChB;;AACD,MAAID,MAAJ,EAAY;AACV,QAAI,CAACH,aAAa,EAAlB,EAAsB;AACpBE,MAAAA,iBAAiB,CAAC;AAACC,QAAAA,MAAM,EAANA,MAAD;AAASC,QAAAA,cAAc,EAAdA;AAAT,OAAD,CAAjB;AACD;;AAED,QAAMM,UAAU,GAAGV,aAAa,EAAhC;;AAEA,QAAIS,KAAJ,EAAW;AACTC,MAAAA,UAAU,CAACD,KAAX,GAAmBA,KAAnB;AACD;;AAED,QAAME,SAAS,GAAG,SAAZA,SAAY,CAAAC,IAAI;AAAA,aAAIL,QAAQ,CAACR,eAAe,CAACa,IAAD,CAAhB,CAAZ;AAAA,KAAtB;;AACAF,IAAAA,UAAU,CAACG,OAAX,CAAmBP,OAAnB,EAA4BK,SAA5B,EAAuCH,OAAvC;AACD,GAbD,MAaO;AACLV,IAAAA,sBAAsB,CAACQ,OAAD,EAAUC,QAAV,EAAoBC,OAApB,CAAtB;AACD;AACF","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {parseStreamDataMessage} from './parse-stream-data-message';\nimport {postDeserialize} from './serialize';\nimport {getWorkerFarm, initializeWorkerFarm} from './parse-stream-workerfarm';\n\n// Public function for initializing workers\nexport function initializeWorkers({worker, maxConcurrency = 4}) {\n  initializeWorkerFarm({worker, maxConcurrency});\n}\n\nexport function parseStreamMessage({\n  message,\n  // callbacks\n  onResult,\n  onError,\n  debug,\n  // worker options\n  worker = false,\n  maxConcurrency = 4\n}) {\n  if (worker) {\n    if (!getWorkerFarm()) {\n      initializeWorkers({worker, maxConcurrency});\n    }\n\n    const workerFarm = getWorkerFarm();\n\n    if (debug) {\n      workerFarm.debug = debug;\n    }\n\n    const onMessage = data => onResult(postDeserialize(data));\n    workerFarm.process(message, onMessage, onError);\n  } else {\n    parseStreamDataMessage(message, onResult, onError);\n  }\n}\n"],"file":"parse-stream-message.js"}