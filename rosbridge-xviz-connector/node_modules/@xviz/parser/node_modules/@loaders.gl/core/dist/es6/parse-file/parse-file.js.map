{"version":3,"sources":["../../../src/parse-file/parse-file.js"],"names":["autoDetectLoader","parseWithLoader","parseWithLoaderSync","parseFileSync","data","loaders","options","url","loader","Array","isArray","parseFile","parseFileAsIterator","inputIterator","parseIterator","iterator","Error","name","parseFileAsAsyncIterator","inputAsyncIterator","parseAsyncIterator","asyncIterator"],"mappings":"AAAA,SAAQA,gBAAR,QAA+B,sBAA/B;AACA,SAAQC,eAAR,EAAyBC,mBAAzB,QAAmD,qBAAnD;AAEA,OAAO,SAASC,aAAT,CAAuBC,IAAvB,EAA6BC,OAA7B,EAAsCC,OAAtC,EAA+CC,GAA/C,EAAoD;AACzD,QAAMC,MAAM,GAAGC,KAAK,CAACC,OAAN,CAAcL,OAAd,IAAyBL,gBAAgB,CAACO,GAAD,EAAMH,IAAN,EAAYC,OAAZ,CAAzC,GAAgEA,OAA/E;AACA,SAAOH,mBAAmB,CAACE,IAAD,EAAOI,MAAP,EAAeF,OAAf,EAAwBC,GAAxB,CAA1B;AACD,C,CAED;;AACA,OAAO,eAAeI,SAAf,CAAyBP,IAAzB,EAA+BC,OAA/B,EAAwCC,OAAxC,EAAiDC,GAAjD,EAAsD;AAC3DH,EAAAA,IAAI,GAAG,MAAMA,IAAb;AACA,QAAMI,MAAM,GAAGC,KAAK,CAACC,OAAN,CAAcL,OAAd,IAAyBL,gBAAgB,CAACO,GAAD,EAAMH,IAAN,EAAYC,OAAZ,CAAzC,GAAgEA,OAA/E;AACA,SAAO,MAAMJ,eAAe,CAACG,IAAD,EAAOI,MAAP,EAAeF,OAAf,EAAwBC,GAAxB,CAA5B;AACD;AAED,OAAO,SAASK,mBAAT,CAA6BC,aAA7B,EAA4CR,OAA5C,EAAqDC,OAArD,EAA8DC,GAA9D,EAAmE;AACxE,QAAMC,MAAM,GAAGC,KAAK,CAACC,OAAN,CAAcL,OAAd,IAAyBL,gBAAgB,CAACO,GAAD,EAAM,IAAN,EAAYF,OAAZ,CAAzC,GAAgEA,OAA/E;;AACA,MAAIG,MAAM,CAACM,aAAX,EAA0B;AACxB,UAAMC,QAAQ,GAAGP,MAAM,CAACM,aAAP,CAAqBD,aAArB,EAAoCP,OAApC,EAA6CC,GAA7C,CAAjB;;AACA,QAAIQ,QAAJ,EAAc;AACZ,aAAOA,QAAP;AACD;AACF,GAPuE,CASxE;;;AACA,QAAM,IAAIC,KAAJ,CAAW,GAAER,MAAM,CAACS,IAAK,8DAAzB,CAAN;AACD,C,CAED;;AACA,OAAO,eAAeC,wBAAf,CAAwCC,kBAAxC,EAA4Dd,OAA5D,EAAqEC,OAArE,EAA8EC,GAA9E,EAAmF;AACxFY,EAAAA,kBAAkB,GAAG,MAAMA,kBAA3B;AACA,QAAMX,MAAM,GAAGC,KAAK,CAACC,OAAN,CAAcL,OAAd,IAAyBL,gBAAgB,CAACO,GAAD,EAAM,IAAN,EAAYF,OAAZ,CAAzC,GAAgEA,OAA/E;;AAEA,MAAIG,MAAM,CAACY,kBAAX,EAA+B;AAC7B,UAAMC,aAAa,GAAGb,MAAM,CAACY,kBAAP,CAA0BD,kBAA1B,EAA8Cb,OAA9C,EAAuDC,GAAvD,CAAtB;;AACA,QAAIc,aAAJ,EAAmB;AACjB,aAAOA,aAAP;AACD;AACF,GATuF,CAUxF;AACA;;;AACA,QAAM,IAAIL,KAAJ,CAAW,GAAER,MAAM,CAACS,IAAK,wDAAzB,CAAN;AACD","sourcesContent":["import {autoDetectLoader} from './auto-detect-loader';\nimport {parseWithLoader, parseWithLoaderSync} from './parse-with-loader';\n\nexport function parseFileSync(data, loaders, options, url) {\n  const loader = Array.isArray(loaders) ? autoDetectLoader(url, data, loaders) : loaders;\n  return parseWithLoaderSync(data, loader, options, url);\n}\n\n// TODO - should accept loader.parseAsyncIterator and concatenate.\nexport async function parseFile(data, loaders, options, url) {\n  data = await data;\n  const loader = Array.isArray(loaders) ? autoDetectLoader(url, data, loaders) : loaders;\n  return await parseWithLoader(data, loader, options, url);\n}\n\nexport function parseFileAsIterator(inputIterator, loaders, options, url) {\n  const loader = Array.isArray(loaders) ? autoDetectLoader(url, null, loaders) : loaders;\n  if (loader.parseIterator) {\n    const iterator = loader.parseIterator(inputIterator, options, url);\n    if (iterator) {\n      return iterator;\n    }\n  }\n\n  // TODO - look for parseSync and pre-concatenate the iterator input\n  throw new Error(`${loader.name} loader cannot parse data source using synchronous iterators`);\n}\n\n// TODO - should accept loader.parseSync/parse and generate 1 chunk asyncIterator\nexport async function parseFileAsAsyncIterator(inputAsyncIterator, loaders, options, url) {\n  inputAsyncIterator = await inputAsyncIterator;\n  const loader = Array.isArray(loaders) ? autoDetectLoader(url, null, loaders) : loaders;\n\n  if (loader.parseAsyncIterator) {\n    const asyncIterator = loader.parseAsyncIterator(inputAsyncIterator, options, url);\n    if (asyncIterator) {\n      return asyncIterator;\n    }\n  }\n  // TODO - look for parseSyncIterator and make an async adapter\n  // TODO - look for parseAsync and pre-concatenate the async iterator input\n  throw new Error(`${loader.name} loader cannot parse data source using async iterators`);\n}\n"],"file":"parse-file.js"}