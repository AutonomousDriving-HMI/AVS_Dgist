function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

// Copyright (c) 2019 Uber Technologies, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

/* global Blob, URL */
import { WorkerFarm } from '../utils/worker-utils';
import { getXVIZConfig, subscribeXVIZConfigChange } from '../config/xviz-config';

/* babel-plugin-inline-import '../../dist/workers/stream-data.worker.js' */
var streamDataWorker = "!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,\"a\",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p=\"\",r(r.s=72)}([function(t,e,r){\"use strict\";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}r.d(e,\"a\",function(){return i})},function(t,e,r){\"use strict\";function n(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}r.d(e,\"a\",function(){return n})},function(t,e,r){\"use strict\";(function(t,n){r.d(e,\"e\",function(){return a}),r.d(e,\"f\",function(){return u}),r.d(e,\"c\",function(){return s}),r.d(e,\"b\",function(){return c}),r.d(e,\"d\",function(){return f}),r.d(e,\"a\",function(){return h});var i=r(3),o={self:\"undefined\"!=typeof self&&self,window:\"undefined\"!=typeof window&&window,global:void 0!==t&&t,document:\"undefined\"!=typeof document&&document,process:\"object\"===(void 0===n?\"undefined\":Object(i.a)(n))&&n},a=o.self||o.window||o.global,u=o.window||o.self||o.global,s=o.global||o.self||o.window,c=o.document||{},f=o.process||{},h=console}).call(this,r(21),r(13))},function(t,e,r){\"use strict\";function n(t){return(n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function i(t){return(i=\"function\"==typeof Symbol&&\"symbol\"===n(Symbol.iterator)?function(t){return n(t)}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":n(t)})(t)}r.d(e,\"a\",function(){return i})},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.subscribeXVIZConfigChange=function(t){s.push(t)},e.setXVIZConfig=function(t){Object.assign(u,t),Array.isArray(u.STREAM_BLACKLIST)&&(u.STREAM_BLACKLIST=new Set(u.STREAM_BLACKLIST));s.forEach(function(t){return t()})},e.getXVIZConfig=function(){return u};var n=o(r(74)),i=o(r(11));function o(t){return t&&t.__esModule?t:{default:t}}var a={supportedVersions:[1,2],currentMajorVersion:1,pathDistanceThreshold:.1,TIME_WINDOW:.4,PLAYBACK_FRAME_RATE:10,STREAM_BLACKLIST:new Set,preProcessPrimitive:function(t){return t},TIMESTAMP_FORMAT:\"seconds\",PRIMARY_POSE_STREAM:\"/vehicle_pose\"},u=Object.assign({},a);i.default.setDefaultCollection(new n.default);var s=[]},function(t,e,r){\"use strict\";(function(t){r.d(e,\"a\",function(){return o}),r.d(e,\"b\",function(){return a});var n=r(3),i=r(8);function o(){return!(\"object\"===(void 0===t?\"undefined\":Object(n.a)(t))&&\"[object process]\"===String(t)&&!t.browser)||Object(i.a)()}function a(){return o()&&\"undefined\"!=typeof document}}).call(this,r(13))},function(t,e,r){\"use strict\";function n(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||\"[object Arguments]\"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}()}r.d(e,\"a\",function(){return n})},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.LOG_STREAM_MESSAGE=void 0;e.LOG_STREAM_MESSAGE={METADATA:\"METADATA\",TIMESLICE:\"TIMESLICE\",DONE:\"DONE\",VIDEO_METADATA:\"VIDEO_METADATA\",VIDEO_FRAME:\"VIDEO_FRAME\",ERROR:\"ERROR\",INCOMPLETE:\"INCOMPLETE\"}},function(t,e,r){\"use strict\";(function(t){r.d(e,\"a\",function(){return i});var n=r(3);function i(e){if(\"undefined\"!=typeof window&&\"object\"===Object(n.a)(window.process)&&\"renderer\"===window.process.type)return!0;if(void 0!==t&&\"object\"===Object(n.a)(t.versions)&&Boolean(t.versions.electron))return!0;var r=\"object\"===(\"undefined\"==typeof navigator?\"undefined\":Object(n.a)(navigator))&&\"string\"==typeof navigator.userAgent&&navigator.userAgent,i=e||r;return!!(i&&i.indexOf(\"Electron\")>=0)}}).call(this,r(13))},,function(t,e){t.exports=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,t}},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=void 0;var n,i=r(29),o=(n=r(85))&&n.__esModule?n:{default:n},a=r(86);function u(t){return(u=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function s(t,e){return!e||\"object\"!==u(e)&&\"function\"!=typeof e?function(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e,r){return e&&f(t.prototype,e),r&&f(t,r),t}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var v=null,y=0,g=function(t){function e(t){var r,n=t.id,i=t.timestamp;return function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,e),(r=s(this,c(e).call(this))).id=n,r.index=y++,r.state={},r.startTime=i,r.endTime=i,r._props=new Map,r._streams=new Map,r._geometry=null,r}return function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,o.default),h(e,null,[{key:\"setDefaultCollection\",value:function(t){v=t}}]),h(e,[{key:\"getBearingToObject\",value:function(t){var e=this.position,r=t.position;return e&&r?Math.atan2(r[1]-e[1],r[0]-e[0])/Math.PI*180:null}},{key:\"getDistanceToObject\",value:function(t){var e=this.position,r=t.position,n=null;return e&&r&&(n=new i.Vector2(e).distance(r),n=Math.round(10*n)/10),n}},{key:\"getProp\",value:function(t){return this._props.get(t)}},{key:\"getFeature\",value:function(t){return this._streams.get(t)}},{key:\"_observe\",value:function(t){this.startTime=Math.min(this.startTime,t),this.endTime=Math.max(this.endTime,t)}},{key:\"_addFeature\",value:function(t,e){this._streams.set(t,e),e.index=this.index,e.state=this.state;var r=!0,n=!1,i=void 0;try{for(var o,a=this._props[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var u=o.value;e[u[0]]=u[1]}}catch(t){n=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}var s=e.center||e.vertices;if(s&&Array.isArray(s)){if(Number.isFinite(s[0]))s[2]=s[2]||0;else if(this._geometry)return;this._geometry=s}}},{key:\"_setState\",value:function(t,e){t&&(this.state[t]=e)}},{key:\"_setProp\",value:function(t,e){this._props.set(t,e)}},{key:\"_reset\",value:function(){this._props.size&&this._props.clear(),this._streams.size&&this._streams.clear(),this._geometry=null}},{key:\"position\",get:function(){var t=this._geometry;return t?Number.isFinite(t[0])?t:(this._geometry=(0,a.getCentroid)(t),this._geometry):null}},{key:\"isValid\",get:function(){return Boolean(this._geometry)}},{key:\"streamNames\",get:function(){return this._streams.keys()}}],[{key:\"observe\",value:function(t,e){return v&&v.observe(t,e)}},{key:\"get\",value:function(t){return v&&v.get(t)}},{key:\"clear\",value:function(){return v&&v.clear()}},{key:\"count\",value:function(){return v&&v.count()}},{key:\"resetAll\",value:function(){return v&&v.resetAll()}},{key:\"getAll\",value:function(){return v&&v.getAll()}},{key:\"getAllInCurrentFrame\",value:function(){return v&&v.getAllInCurrentFrame()}},{key:\"prune\",value:function(t,e){return v&&v.prune(t,e)}}]),e}();e.default=g},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.normalizeXVIZPrimitive=function(t,e,r,n,i,o,a){var u=e.type||i,s=e.vertices,c=e.center,f=t[u],h=f.enableZOffset,l=f.validate,v=f.normalize;if(h){var y=1e-6*r;if(s)for(var g=0;g<s.length;g++)s[g][2]=y;c&&2===c.length&&(c[2]=y)}u&&(e.type=u);if(!l(e,n,o))return null;v&&v(e);a&&a(e);return e},e.PRIMITIVE_CAT=void 0;e.PRIMITIVE_CAT={LOOKAHEAD:\"lookAheads\",FEATURE:\"features\",LABEL:\"labels\",POINTCLOUD:\"pointCloud\",IMAGE:\"images\",COMPONENT:\"components\"}},function(t,e){var r,n,i=t.exports={};function o(){throw new Error(\"setTimeout has not been defined\")}function a(){throw new Error(\"clearTimeout has not been defined\")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r=\"function\"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{n=\"function\"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var s,c=[],f=!1,h=-1;function l(){f&&s&&(f=!1,s.length?c=s.concat(c):h=-1,c.length&&v())}function v(){if(!f){var t=u(l);f=!0;for(var e=c.length;e;){for(s=c,c=[];++h<e;)s&&s[h].run();h=-1,e=c.length}s=null,f=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function y(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new y(t,e)),1!==c.length||f||u(v)},y.prototype.run=function(){this.fun.apply(null,this.array)},i.title=\"browser\",i.browser=!0,i.env={},i.argv=[],i.version=\"\",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error(\"process.binding is not supported\")},i.cwd=function(){return\"/\"},i.chdir=function(t){throw new Error(\"process.chdir is not supported\")},i.umask=function(){return 0}},function(t,e){t.exports=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],u=r[1],s=r[2];return t[0]=i*s-o*u,t[1]=o*a-n*s,t[2]=n*u-i*a,t}},function(t,e){t.exports=function(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)}},function(t,e,r){t.exports=r(80)},function(t,e){t.exports=function(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}},function(t,e){t.exports=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],h=e[8],l=e[9],v=e[10],y=e[11],g=e[12],d=e[13],p=e[14],m=e[15],b=r[0],E=r[1],k=r[2],w=r[3];return t[0]=b*n+E*u+k*h+w*g,t[1]=b*i+E*s+k*l+w*d,t[2]=b*o+E*c+k*v+w*p,t[3]=b*a+E*f+k*y+w*m,b=r[4],E=r[5],k=r[6],w=r[7],t[4]=b*n+E*u+k*h+w*g,t[5]=b*i+E*s+k*l+w*d,t[6]=b*o+E*c+k*v+w*p,t[7]=b*a+E*f+k*y+w*m,b=r[8],E=r[9],k=r[10],w=r[11],t[8]=b*n+E*u+k*h+w*g,t[9]=b*i+E*s+k*l+w*d,t[10]=b*o+E*c+k*v+w*p,t[11]=b*a+E*f+k*y+w*m,b=r[12],E=r[13],k=r[14],w=r[15],t[12]=b*n+E*u+k*h+w*g,t[13]=b*i+E*s+k*l+w*d,t[14]=b*o+E*c+k*v+w*p,t[15]=b*a+E*f+k*y+w*m,t}},function(t,e){t.exports=function(t,e){var r=e[0],n=e[1],i=e[2],o=r*r+n*n+i*i;o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o);return t}},function(t,e){t.exports=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}},function(t,e){var r;r=function(){return this}();try{r=r||new Function(\"return this\")()}catch(t){\"object\"==typeof window&&(r=window)}t.exports=r},function(t,e,r){\"use strict\";e.byteLength=function(t){var e=c(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){for(var e,r=c(t),n=r[0],a=r[1],u=new o(function(t,e,r){return 3*(e+r)/4-r}(0,n,a)),s=0,f=a>0?n-4:n,h=0;h<f;h+=4)e=i[t.charCodeAt(h)]<<18|i[t.charCodeAt(h+1)]<<12|i[t.charCodeAt(h+2)]<<6|i[t.charCodeAt(h+3)],u[s++]=e>>16&255,u[s++]=e>>8&255,u[s++]=255&e;2===a&&(e=i[t.charCodeAt(h)]<<2|i[t.charCodeAt(h+1)]>>4,u[s++]=255&e);1===a&&(e=i[t.charCodeAt(h)]<<10|i[t.charCodeAt(h+1)]<<4|i[t.charCodeAt(h+2)]>>2,u[s++]=e>>8&255,u[s++]=255&e);return u},e.fromByteArray=function(t){for(var e,r=t.length,i=r%3,o=[],a=0,u=r-i;a<u;a+=16383)o.push(f(t,a,a+16383>u?u:a+16383));1===i?(e=t[r-1],o.push(n[e>>2]+n[e<<4&63]+\"==\")):2===i&&(e=(t[r-2]<<8)+t[r-1],o.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+\"=\"));return o.join(\"\")};for(var n=[],i=[],o=\"undefined\"!=typeof Uint8Array?Uint8Array:Array,a=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",u=0,s=a.length;u<s;++u)n[u]=a[u],i[a.charCodeAt(u)]=u;function c(t){var e=t.length;if(e%4>0)throw new Error(\"Invalid string. Length must be a multiple of 4\");var r=t.indexOf(\"=\");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function f(t,e,r){for(var i,o,a=[],u=e;u<r;u+=3)i=(t[u]<<16&16711680)+(t[u+1]<<8&65280)+(255&t[u+2]),a.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return a.join(\"\")}i[\"-\".charCodeAt(0)]=62,i[\"_\".charCodeAt(0)]=63},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.parseLogMetadata=function(t){var e=(0,n.getXVIZConfig)().supportedVersions,r=t.version,o=null;if(void 0===r)o=1;else{var a=(0,i.parseVersionString)(r),u=a.major;o=u}if(!o)throw new Error(\"Unable to detect the XVIZ version.\");(0,n.setXVIZConfig)({currentMajorVersion:o});if(e&&!e.includes(o))throw new Error(\"XVIZ version \".concat(o,\" is not supported.  Currently supported versions are \").concat(e,\".\"));return 1===o?s(t):c(t)},e.parseLogMetadataV1=s,e.parseLogMetadataV2=c;var n=r(4),i=r(24);function o(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||\"[object Arguments]\"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}()}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){u(t,e,r[e])})}return t}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t){var e=t.streams||[],r=(0,n.getXVIZConfig)().STREAM_BLACKLIST,i={};Object.keys(e).forEach(function(t){r.has(t)||(i[t]=e[t])});var o=f(t),u=o.logStartTime,s=o.logEndTime,c=o.eventStartTime,h=o.eventEndTime;return a({},t,{streams:i,logStartTime:u,logEndTime:s,eventStartTime:c,eventEndTime:h})}function c(t){var e=t.streams,r=(0,n.getXVIZConfig)().STREAM_BLACKLIST,i={};e&&Object.keys(e).forEach(function(t){r.has(t)||(i[t]=e[t])});var u,s,c=f(t.log_info||{}),h=c.logStartTime,l=c.logEndTime,v=c.eventStartTime,y=c.eventEndTime,g=(u=i,s={},Object.keys(u).forEach(function(t){var e=u[t],r=[];e.stream_style&&r.push({name:\"*\",style:e.stream_style}),e.style_classes&&r.push.apply(r,o(e.style_classes)),0!==r.length&&(s[t]=r)}),s);return a({},t,{streams:i,logStartTime:h,logEndTime:l,start_time:v,end_time:y,eventStartTime:v,eventEndTime:y,styles:g})}function f(t){var e=Number.isFinite(t.log_start_time)?t.log_start_time:null,r=Number.isFinite(t.log_end_time)?t.log_end_time:null;return{logStartTime:e,logEndTime:r,eventStartTime:Number.isFinite(t.start_time)?t.start_time:e,eventEndTime:Number.isFinite(t.end_time)?t.end_time:r}}},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.parseVersionString=function(t){var e=t.split(\".\"),r=null,n=null,i=null,o=e.shift();o&&(r=Number.parseInt(o,10));(o=e.shift())&&(n=Number.parseInt(o,10));(o=e.shift())&&(i=Number.parseInt(o,10));return{major:r,minor:n,patch:i}},e.getPrimitiveData=function(t){var e=(0,n.getXVIZConfig)().currentMajorVersion;if(1===e&&t instanceof Array){if(0===t.length)return{type:null,primitives:t};if(t.length>0)return{type:t[0].type,primitives:t}}if(2===e)for(var r=Object.keys(t),o=0;o<r.length;o++){var a=r[o];if(i.includes(a)){var u=a.slice(0,-1);return{type:u,primitives:t[a]}}}return{}},e.unFlattenVertices=o,e.ensureUnFlattenedVertices=function(t){if(t.length>0&&!Array.isArray(t[0]))return o(t);return t};var n=r(4),i=[\"circles\",\"images\",\"points\",\"polygons\",\"polylines\",\"stadiums\",\"texts\"];function o(t){for(var e=[],r=0;r<t.length;r+=3)e.push([t[r],t[r+1],t[r+2]]);return e}},function(t,e,r){\"use strict\";\"undefined\"==typeof TextDecoder?t.exports=r(94):t.exports={TextEncoder:TextEncoder,TextDecoder:TextDecoder}},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.parseXVIZStream=function(t,e){var r=t[0],n=r.primitives,i=r.ui_primitives,o=r.variables,a=r.futures;if(n){var u=Object.keys(n)[0];return t.map(function(t){return l(t.primitives[u],u,t.timestamp,e)})}if(o){var s=Object.keys(o)[0];return t.map(function(t){return d(t.variables[s],s,t.timestamp)})}if(a){var c=Object.keys(a)[0];return t.map(function(t){return v(t.futures[c],c,t.timestamp,e)})}if(i){var f=Object.keys(i)[0];return t.map(function(t){return _(t.ui_primitives[f],f,t.timestamp)})}return{}},e.parseStreamPrimitive=l,e.parseStreamFutures=v,e.parseStreamFuturesV1=y,e.parseStreamFuturesV2=g,e.parseStreamVariable=d,e.parseStreamVariableV1=p,e.parseStreamVariableV2=m,e.parseStreamTimeSeries=function(t,e){var r=(0,n.getXVIZConfig)().currentMajorVersion;if(2===r)return function(t,e){if(!Array.isArray(t))return{};var r={};return t.forEach(function(t){var n=t.timestamp,i=t.streams,o=t.values,a=t.object_id,s=E(o);return s&&s.values.length===i.length?(s.values.forEach(function(t,o){var s=i[o];if(!e.has(s)){var c={time:n,variable:t};a&&(c.id=a),r[s]?u.default.warn(\"Unexpected time_series duplicate: \".concat(s))():r[s]=c}}),r):null}),r}(t,e);return u.default.error(\"Invalid time_series data in XVIZ version \".concat(r))(),null},e.parseStreamUIPrimitives=_;var n=r(4),i=r(12),o=h(r(11)),a=r(97),u=h(r(27)),s=r(24),c=h(r(99)),f=h(r(100));function h(t){return t&&t.__esModule?t:{default:t}}function l(t,e,r,h){var l=(0,n.getXVIZConfig)(),v=l.OBJECT_STREAM,y=l.preProcessPrimitive,g=1===(0,n.getXVIZConfig)().currentMajorVersion?c.default:f.default,d=(0,s.getPrimitiveData)(t);if(!d||!Array.isArray(d.primitives))return{};for(var p=d.type,m=d.primitives,b=function(){var t={};for(var e in i.PRIMITIVE_CAT)t[i.PRIMITIVE_CAT[e]]=[];return t}(),E=null,_=0;_<m.length;_++){var A=m[_];if(A&&Array.isArray(A)){b[E=i.PRIMITIVE_CAT.LOOKAHEAD].push([]);for(var T=0;T<A.length;T++){y({primitive:A[T],streamName:e,time:r});var M=(0,i.normalizeXVIZPrimitive)(g,A[T],_,e,p,r,h);M&&b[E][_].push(M)}}else{y({primitive:A,streamName:e,time:r});var O=(0,i.normalizeXVIZPrimitive)(g,A,_,e,p,r,h);E=g[A.type||p].category,O&&(b[E].push(O),a.isMainThread&&(e===v||!v&&O.id&&\"features\"===E)&&o.default.observe(O.id,r))}}return b.pointCloud=function(t){if(0===t.length)return null;var e=0,r=!0,n=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var s=o.value;e+=k(s.vertices)}}catch(t){n=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}var c=null,f=new Float32Array(3*e),h=new Uint8ClampedArray(4*e),l=new Uint32Array(e),v=0;return t.forEach(function(t){var e=t.vertices,r=t.colors,n=k(e);if(0!==n){var i=function(t,e){if(t){if(t.length/4===e)return 4;if(t.length/3===e)return 3;var r;if(3===(r=Array.isArray(t[0])?t[0].length:t.length)||4===r)return r;u.default.error(\"Unknown point color format\")}return 0}(r||t.color,n);null!==c&&c!==i&&u.default.error(\"Inconsistent point color format\"),c=i;var o=r&&r.length===n*c;o&&h.set(r,v*c);var a=e.length===3*n;a&&f.set(e,3*v);for(var s=t.color||w,y=0;y<n;y++,v++){if(l[v]=t.id,!a){var g=e[y];f[3*v+0]=g[0],f[3*v+1]=g[1],f[3*v+2]=g[2]}!o&&c&&(r&&(s=r[y]),h[v*c+0]=s[0],h[v*c+1]=s[1],h[v*c+2]=s[2],4===c&&(h[v*c+3]=s[3]||255))}}}),{type:t[0].type,numInstances:e,positions:f,colors:c?h.subarray(0,c*e):null,ids:l}}(b.pointCloud),b.time=r,b}function v(t,e,r,i){return 1===(0,n.getXVIZConfig)().currentMajorVersion?y(t,e,r,i):g(t,e,r,i)}function y(t,e,r,n){var o=[];return t.forEach(function(t,a){var u=t.primitives.map(function(t){return(0,i.normalizeXVIZPrimitive)(c.default,t,a,e,t.type,r,n)}).filter(Boolean);o.push(u)}),{time:r,lookAheads:o}}function g(t,e,r,n){var o=[],a=t.timestamps;return t.primitives.forEach(function(t,u){var c=(0,s.getPrimitiveData)(t),h=c.primitives.map(function(t){var o=(0,i.normalizeXVIZPrimitive)(f.default,t,u,e,c.type,r,n);return o.timestamp=a[u],o}).filter(Boolean);o.push(h)}),{time:r,lookAheads:o}}function d(t,e,r){return 1===(0,n.getXVIZConfig)().currentMajorVersion?p(t,e,r):m(t,e,r)}function p(t,e,r){if(Array.isArray(t))return{time:r};var n=t.timestamps,i=t.values;return{time:r,variable:1===i.length?i[0]:n?i.map(function(t,e){return[n[e],t]}):i}}function m(t,e,r){if(Array.isArray(t))return{time:r};var n=t.variables;if(!n||!Array.isArray(n))return{};var i={time:r};return i.variable=n.map(function(t){var e=t.base,r=E(t.values);if(!r||!r.values)return null;var n={values:r.values};return e&&e.object_id&&(n.id=e.object_id),n}).filter(Boolean),i}var b=[\"doubles\",\"int32s\",\"bools\",\"strings\"];function E(t){for(var e=Object.keys(t),r=0;r<e.length;r++){var n=e[r];if(b.includes(n))return{type:n,values:t[n]}}return{}}function k(t){return Number.isFinite(t[0])?t.length/3:t.length}var w=[0,0,0,255];function _(t,e,r){return Object.assign({time:r},t)}},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=void 0;var n=new(r(106).Log)({id:\"xviz\"}).enable();e.default=n},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.filterVertices=function(t){for(var e=(0,i.getXVIZConfig)().pathDistanceThreshold,r=Number.isFinite(t[0]),a=r?t.length/3:t.length,u=[],s=0,c=null,f=-1,h=0;h<a;h++){var l=o(t,h,r),v=-1===f||c.distance(l)>e;v&&(u[s++]=l[0],u[s++]=l[1],u[s++]=l[2],c=new n.Vector3(l),f=h)}if(f!==a-1){var y=o(t,a-1,r);s-=3,u[s++]=y[0],u[s++]=y[1],u[s++]=y[2]}return u};var n=r(29),i=r(4);function o(t,e){var r=null;return(r=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?t.slice(3*e,3*e+3):t[e])[2]=r[2]||0,r}},function(t,e,r){\"use strict\";r.r(e);var n=r(1),i=r(0),o=r(3);function a(t,e){return!e||\"object\"!==Object(o.a)(e)&&\"function\"!=typeof e?function(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}var f={};function h(t){\"epsilon\"in t&&(f.EPSILON=t.epsilon),\"debug\"in t&&(f.debug=t.debug)}function l(t){if(!Number.isFinite(t))throw new Error(\"Invalid number \".concat(t));return t}function v(t){return Math.round(t/f.EPSILON)*f.EPSILON}function y(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).precision,r=void 0===e?f.precision||4:e;return t=v(t),parseFloat(t.toPrecision(r))}function g(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&void 0!==t.length}function d(t){return t.clone?t.clone():new Array(t)}function p(t,e){if(g(t)){for(var r=d(t),n=0;n<r.length;++n)r[n]=e(r[n],n,r);return r}return e(t)}function m(t){return p(t,function(t){return t/180*Math.PI})}function b(t){return p(t,function(t){return 180*t/Math.PI})}function E(t){return p(t,function(t){return Math.sin(t)})}function k(t){return p(t,function(t){return Math.cos(t)})}function w(t){return p(t,function(t){return Math.tan(t)})}function _(t){return p(t,function(t){return Math.asin(t)})}function A(t){return p(t,function(t){return Math.acos(t)})}function T(t){return p(t,function(t){return Math.atan(t)})}function M(t,e,r){return p(t,function(t){return Math.max(e,Math.min(r,t))})}function O(t,e,r){return g(t)?t.map(function(t,n){return O(t,e[n],r)}):r*e+(1-r)*t}function S(t,e){if(g(t)&&g(e)){if(t===e)return!0;if(t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(!S(t[r],e[r]))return!1;return!0}return Math.abs(t-e)<=f.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}function j(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}f.EPSILON=1e-12,f.debug=!0,f.precision=4,f.printTypes=!1,f.printDegrees=!1,f.printRowMajor=!0;var I=function(t){function e(){return Object(n.a)(this,e),a(this,u(e).apply(this,arguments))}return c(e,j(Array)),Object(i.a)(e,[{key:\"clone\",value:function(){return(new this.constructor).copy(this).check()}},{key:\"copy\",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t[e];return this.check()}},{key:\"set\",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=(t<0||arguments.length<=t?void 0:arguments[t])||0;return this.check()}},{key:\"fromArray\",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<this.ELEMENTS;++r)this[r]=t[r+e];return this.check()}},{key:\"toString\",value:function(){return this.formatString(f)}},{key:\"formatString\",value:function(t){for(var e=\"\",r=0;r<this.ELEMENTS;++r)e+=(r>0?\", \":\"\")+y(this[r],t);return\"\".concat(t.printTypes?this.constructor.name:\"\",\"[\").concat(e,\"]\")}},{key:\"toArray\",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<this.ELEMENTS;++r)t[e+r]=this[r];return t}},{key:\"toFloat32Array\",value:function(){return new Float32Array(this)}},{key:\"equals\",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!S(this[e],t[e]))return!1;return!0}},{key:\"exactEquals\",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:\"negate\",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:\"inverse\",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=1/this[t];return this.check()}},{key:\"lerp\",value:function(t,e,r){void 0===r&&(r=e,e=t,t=this);for(var n=0;n<this.ELEMENTS;++n){var i=t[n];this[n]=i+r*(e[n]-i)}return this.check()}},{key:\"min\",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:\"max\",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:\"clamp\",value:function(t,e){for(var r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],t[r]),e[r]);return this.check()}},{key:\"validate\",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,e=t&&t.length===this.ELEMENTS,r=0;r<this.ELEMENTS;++r)e=e&&Number.isFinite(t[r]);return e}},{key:\"check\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;if(f.debug&&!this.validate(t))throw new Error(\"math.gl: \".concat(this.constructor.name,\" some fields set to invalid numbers'\"));return this}},{key:\"sub\",value:function(t){return this.subtract(t)}},{key:\"setScalar\",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:\"addScalar\",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:\"subScalar\",value:function(t){return this.addScalar(-t)}},{key:\"multiplyScalar\",value:function(t){return this.scale(t)}},{key:\"divideScalar\",value:function(t){return this.scale(1/t)}},{key:\"clampScalar\",value:function(t,e){for(var r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],t),e);return this.check()}}]),e}(),x=function(t,e){if(!t)throw new Error(e)},P=function(t){function e(){return Object(n.a)(this,e),a(this,u(e).apply(this,arguments))}return c(e,I),Object(i.a)(e,[{key:\"len\",value:function(){return Math.sqrt(this.lengthSquared())}},{key:\"magnitude\",value:function(){return Math.sqrt(this.lengthSquared())}},{key:\"lengthSquared\",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:\"distance\",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:\"distanceSquared\",value:function(t){for(var e=0,r=0;r<this.ELEMENTS;++r){var n=this[r]-t[r];e+=n*n}return l(e)}},{key:\"dot\",value:function(t){for(var e=0,r=0;r<this.ELEMENTS;++r)e+=this[r]*t[r];return l(e)}},{key:\"normalize\",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:\"add\",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0;n<e.length;n++)for(var i=e[n],o=0;o<this.ELEMENTS;++o)this[o]+=i[o];return this.check()}},{key:\"subtract\",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0;n<e.length;n++)for(var i=e[n],o=0;o<this.ELEMENTS;++o)this[o]-=i[o];return this.check()}},{key:\"multiply\",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0;n<e.length;n++)for(var i=e[n],o=0;o<this.ELEMENTS;++o)this[o]*=i[o];return this.check()}},{key:\"divide\",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0;n<e.length;n++)for(var i=e[n],o=0;o<this.ELEMENTS;++o)this[o]/=i[o];return this.check()}},{key:\"scale\",value:function(t){if(Array.isArray(t))return this.multiply(t);for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:\"scaleAndAdd\",value:function(t,e){for(var r=0;r<this.ELEMENTS;++r)this[r]=this[r]*e+t[r];return this.check()}},{key:\"lengthSq\",value:function(){return this.lengthSquared()}},{key:\"distanceTo\",value:function(t){return this.distance(t)}},{key:\"distanceToSquared\",value:function(t){return this.distanceSquared(t)}},{key:\"getComponent\",value:function(t){return x(t>=0&&t<this.ELEMENTS,\"index is out of range\"),l(this[t])}},{key:\"setComponent\",value:function(t,e){return x(t>=0&&t<this.ELEMENTS,\"index is out of range\"),this[t]=e,this.check()}},{key:\"addVectors\",value:function(t,e){return this.copy(t).add(e)}},{key:\"subVectors\",value:function(t,e){return this.copy(t).subtract(e)}},{key:\"multiplyVectors\",value:function(t,e){return this.copy(t).multiply(e)}},{key:\"addScaledVector\",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}},{key:\"x\",get:function(){return this[0]},set:function(t){return this[0]=l(t)}},{key:\"y\",get:function(){return this[1]},set:function(t){return this[1]=l(t)}}]),e}(),R=r(30),L=r.n(R),B=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(n.a)(this,e),t=a(this,u(e).call(this)),Array.isArray(r)&&1===arguments.length?t.copy(r):t.set(r,i),t}return c(e,P),Object(i.a)(e,[{key:\"cross\",value:function(t){return L()(this,this,t),this.check()}},{key:\"horizontalAngle\",value:function(){return Math.atan2(this.y,this.x)}},{key:\"verticalAngle\",value:function(){return Math.atan2(this.x,this.y)}},{key:\"operation\",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.apply(void 0,[this,this].concat(r)),this.check()}},{key:\"ELEMENTS\",get:function(){return 2}}]),e}(),C=r(31),V=r.n(C),U=r(14),N=r.n(U),D=r(32),F=r.n(D),Y=r(33),Z=r.n(Y),X=r(34),G=r.n(X),z=[0,0,0],q=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(n.a)(this,e),t=a(this,u(e).call(this)),Array.isArray(r)&&1===arguments.length?t.copy(r):t.set(r,i,o),t}return c(e,P),Object(i.a)(e,[{key:\"angle\",value:function(t){return V()(this,t)}},{key:\"cross\",value:function(t){return N()(this,this,t),this.check()}},{key:\"rotateX\",value:function(t){var e=t.radians,r=t.origin,n=void 0===r?z:r;return F()(this,this,n,e),this.check()}},{key:\"rotateY\",value:function(t){var e=t.radians,r=t.origin,n=void 0===r?z:r;return Z()(this,this,n,e),this.check()}},{key:\"rotateZ\",value:function(t){var e=t.radians,r=t.origin,n=void 0===r?z:r;return G()(this,this,n,e),this.check()}},{key:\"operation\",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.apply(void 0,[this,this].concat(r)),this.check()}},{key:\"ELEMENTS\",get:function(){return 3}},{key:\"z\",get:function(){return this[2]},set:function(t){return this[2]=l(t)}}]),e}(),J=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object(n.a)(this,e),t=a(this,u(e).call(this)),Array.isArray(r)&&1===arguments.length?t.copy(r):t.set(r,i,o,s),t}return c(e,P),Object(i.a)(e,[{key:\"applyMatrix4\",value:function(t){return t.transformVector(this,this),this}},{key:\"ELEMENTS\",get:function(){return 4}},{key:\"z\",get:function(){return this[2]},set:function(t){return this[2]=l(t)}},{key:\"w\",get:function(){return this[3]},set:function(t){return this[3]=l(t)}}]),e}();function H(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==u.return||u.return()}finally{if(i)throw o}}return r}(t,e)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}var W=r(6),K=r(35),Q=r.n(K),$=r(36),tt=r.n($),et=r(37),rt=r.n(et),nt=r(38),it=r.n(nt),ot=r(39),at=r.n(ot),ut=r(40),st=r.n(ut),ct=r(41),ft=r.n(ct),ht=r(42),lt=r.n(ht),vt=r(18),yt=r.n(vt),gt=r(43),dt=r.n(gt),pt=r(44),mt=r.n(pt),bt=r(45),Et=r.n(bt),kt=r(46),wt=r.n(kt),_t=r(47),At=r.n(_t),Tt=r(10),Mt=r.n(Tt),Ot=r(48),St=r.n(Ot),jt=r(49),It=r.n(jt),xt=r(50),Pt=r.n(xt),Rt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function Lt(t,e){return t.length===e&&t.every(Number.isFinite)}var Bt=function(t){function e(){for(var t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Object(n.a)(this,e),t=a(this,u(e).call(this)),Array.isArray(i[0])&&1===arguments.length?t.copy(i[0]):t.identity(),t}return c(e,I),Object(i.a)(e,[{key:\"setRowMajor\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,h=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,l=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,v=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,y=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,g=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;return this[0]=t,this[1]=i,this[2]=s,this[3]=l,this[4]=e,this[5]=o,this[6]=c,this[7]=v,this[8]=r,this[9]=a,this[10]=f,this[11]=y,this[12]=n,this[13]=u,this[14]=h,this[15]=g,this.check()}},{key:\"setColumnMajor\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,h=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,l=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,v=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,y=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,g=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;return this[0]=t,this[1]=e,this[2]=r,this[3]=n,this[4]=i,this[5]=o,this[6]=a,this[7]=u,this[8]=s,this[9]=c,this[10]=f,this[11]=h,this[12]=l,this[13]=v,this[14]=y,this[15]=g,this.check()}},{key:\"copy\",value:function(t){return this.setColumnMajor.apply(this,Object(W.a)(t))}},{key:\"set\",value:function(){return this.setColumnMajor.apply(this,arguments)}},{key:\"getElement\",value:function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this[t][e]:this[e][t]}},{key:\"setElement\",value:function(t,e,r){return arguments.length>3&&void 0!==arguments[3]&&arguments[3]?this[t][e]=l(r):this[e][t]=l(r),this}},{key:\"determinant\",value:function(){return Q()(this)}},{key:\"identity\",value:function(){return this.copy(Rt)}},{key:\"fromQuaternion\",value:function(t){return tt()(this,t),this.check()}},{key:\"frustum\",value:function(t){var e=t.left,r=t.right,n=t.bottom,i=t.top,o=t.near,a=t.far;return rt()(this,e,r,n,i,o,a),this.check()}},{key:\"lookAt\",value:function(t){var e=t.eye,r=t.center,n=void 0===r?[0,0,0]:r,i=t.up,o=void 0===i?[0,1,0]:i;return it()(this,e,n,o),this.check()}},{key:\"ortho\",value:function(t){var e=t.left,r=t.right,n=t.bottom,i=t.top,o=t.near,a=void 0===o?.1:o,u=t.far,s=void 0===u?500:u;return at()(this,e,r,n,i,a,s),this.check()}},{key:\"orthographic\",value:function(t){var r=t.fovy,n=void 0===r?45*Math.PI/180:r,i=t.aspect,o=void 0===i?1:i,a=t.focalDistance,u=void 0===a?1:a,s=t.near,c=void 0===s?.1:s,f=t.far,h=void 0===f?500:f;if(n>2*Math.PI)throw Error(\"radians\");var l=n/2,v=u*Math.tan(l),y=v*o;return(new e).ortho({left:-y,right:y,bottom:-v,top:v,near:c,far:h})}},{key:\"perspective\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.fovy,r=t.fov,n=void 0===r?45*Math.PI/180:r,i=t.aspect,o=void 0===i?1:i,a=t.near,u=void 0===a?.1:a,s=t.far,c=void 0===s?500:s;if((e=e||n)>2*Math.PI)throw Error(\"radians\");return st()(this,e,o,u,c),this.check()}},{key:\"transpose\",value:function(){return ft()(this,this),this.check()}},{key:\"invert\",value:function(){return lt()(this,this),this.check()}},{key:\"multiplyLeft\",value:function(t){return yt()(this,t,this),this.check()}},{key:\"multiplyRight\",value:function(t){return yt()(this,this,t),this.check()}},{key:\"rotateX\",value:function(t){return St()(this,this,t),this.check()}},{key:\"rotateY\",value:function(t){return It()(this,this,t),this.check()}},{key:\"rotateZ\",value:function(t){return Pt()(this,this,t),this.check()}},{key:\"rotateXYZ\",value:function(t){var e=H(t,3),r=e[0],n=e[1],i=e[2];return this.rotateX(r).rotateY(n).rotateZ(i)}},{key:\"rotateAxis\",value:function(t,e){return dt()(this,this,t,e),this.check()}},{key:\"scale\",value:function(t){return mt()(this,this,t),this.check()}},{key:\"translate\",value:function(t){return Et()(this,this,t),this.check()}},{key:\"transformVector2\",value:function(t,e){return e=e||new B,wt()(e,t,this),Lt(e,2),e}},{key:\"transformVector3\",value:function(t,e){return e=e||new q,At()(e,t,this),Lt(e,3),e}},{key:\"transformVector4\",value:function(t,e){return e=e||new J,Mt()(e,t,this),Lt(e,4),e.check()}},{key:\"transformVector\",value:function(t,e){switch(t.length){case 2:return this.transformVector2(t,e);case 3:return this.transformVector3(t,e);case 4:return this.transformVector4(t,e);default:throw new Error(\"Illegal vector\")}}},{key:\"transformDirection\",value:function(t,e){return this._transformVector(t,e,0)}},{key:\"transformPoint\",value:function(t,e){return this._transformVector(t,e,1)}},{key:\"_transformVector\",value:function(t,e,r){switch(t.length){case 2:e=e||new B,Mt()(e,[t[0],t[1],0,r],this),e.length=2,Lt(e,2);break;case 3:e=e||new q,Mt()(e,[t[0],t[1],t[2],r],this),e.length=3,Lt(e,3);break;case 4:if(Boolean(r)!==Boolean(t[3]))throw new Error(\"math.gl: Matrix4.transformPoint - invalid vector\");e=e||new J,Mt()(e,t,this),Lt(e,4);break;default:throw new Error(\"Illegal vector\")}return e}},{key:\"makeRotationX\",value:function(t){return this.identity().rotateX(t)}},{key:\"makeTranslation\",value:function(t,e,r){return this.identity().translate([t,e,r])}},{key:\"ELEMENTS\",get:function(){return 16}}]),e}(),Ct=r(51),Vt=r.n(Ct),Ut=r(52),Nt=r.n(Ut),Dt=r(53),Ft=r.n(Dt),Yt=r(54),Zt=r.n(Yt),Xt=r(55),Gt=r.n(Xt),zt=r(56),qt=r.n(zt),Jt=r(57),Ht=r.n(Jt),Wt=r(58),Kt=r.n(Wt),Qt=r(59),$t=r.n(Qt),te=r(60),ee=r.n(te),re=r(61),ne=r.n(re),ie=r(62),oe=r.n(ie),ae=r(16),ue=r.n(ae),se=r(63),ce=r.n(se),fe=r(64),he=r.n(fe),le=r(65),ve=r.n(le),ye=r(66),ge=r.n(ye),de=r(67),pe=r.n(de),me=r(17),be=r.n(me),Ee=r(68),ke=r.n(Ee),we=[0,0,0,1];var _e=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(n.a)(this,e),t=a(this,u(e).call(this)),Array.isArray(r)&&1===arguments.length?t.copy(r):t.set(r,i,o,s),t}return c(e,I),Object(i.a)(e,[{key:\"fromMatrix3\",value:function(t){return Vt()(this,t),this.check()}},{key:\"fromValues\",value:function(t,e,r,n){return this.set(t,e,r,n)}},{key:\"identity\",value:function(){return Nt()(this),this.check()}},{key:\"length\",value:function(){return Ft()(this)}},{key:\"squaredLength\",value:function(t){return Zt()(this)}},{key:\"dot\",value:function(t,e){if(void 0!==e)throw new Error(\"Quaternion.dot only takes one argument\");return Gt()(this,t)}},{key:\"rotationTo\",value:function(t,e){return qt()(this,t,e),this.check()}},{key:\"add\",value:function(t,e){if(void 0!==e)throw new Error(\"Quaternion.add only takes one argument\");return Ht()(this,t),this.check()}},{key:\"calculateW\",value:function(){return Kt()(this,this),this.check()}},{key:\"conjugate\",value:function(){return $t()(this,this),this.check()}},{key:\"invert\",value:function(){return ee()(this,this),this.check()}},{key:\"lerp\",value:function(t,e,r){return ne()(this,t,e,r),this.check()}},{key:\"multiply\",value:function(t,e){if(void 0!==e)throw new Error(\"Quaternion.multiply only takes one argument\");return oe()(this,this,e),this.check()}},{key:\"normalize\",value:function(){return ue()(this,this),this.check()}},{key:\"rotateX\",value:function(t){return ce()(this,this,t),this.check()}},{key:\"rotateY\",value:function(t){return he()(this,this,t),this.check()}},{key:\"rotateZ\",value:function(t){return ve()(this,this,t),this.check()}},{key:\"scale\",value:function(t){return ge()(this,this,t),this.check()}},{key:\"set\",value:function(t,e,r,n){return pe()(this,t,e,r,n),this.check()}},{key:\"setAxisAngle\",value:function(t,e){return be()(this,t,e),this.check()}},{key:\"slerp\",value:function(t){var e=t.start,r=void 0===e?we:e,n=t.target,i=t.ratio;return ke()(this,r,n,i),this.check()}},{key:\"ELEMENTS\",get:function(){return 4}},{key:\"x\",get:function(){return this[0]},set:function(t){return this[0]=l(t)}},{key:\"y\",get:function(){return this[1]},set:function(t){return this[1]=l(t)}},{key:\"z\",get:function(){return this[2]},set:function(t){return this[2]=l(t)}},{key:\"w\",get:function(){return this[3]},set:function(t){return this[3]=l(t)}}]),e}(),Ae=r(15),Te=r.n(Ae),Me=6371e3,Oe=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.phi,i=e.theta,o=e.radius,a=e.bearing,u=e.pitch,s=(e.altitude,e.radiusScale),c=void 0===s?Me:s;Object(n.a)(this,t),0===arguments.length?(this.phi=0,this.theta=0,this.radius=1):Number.isFinite(r)||Number.isFinite(i)?(this.phi=r||0,this.theta=i||0):(Number.isFinite(a)||Number.isFinite(u))&&(this.bearing=a||0,this.pitch=u||0),this.radius=o||1,this.radiusScale=c||1,this.check()}return Object(i.a)(t,[{key:\"toString\",value:function(){return this.formatString(f)}},{key:\"formatString\",value:function(t){var e=t.printTypes,r=(t.printDegrees,y);return\"\".concat(e?\"Spherical\":\"\",\"[rho:\").concat(r(this.radius),\",theta:\").concat(r(this.theta),\",phi:\").concat(r(this.phi),\"]\")}},{key:\"equals\",value:function(t){return S(this.radius,t.radius)&&S(this.theta,t.theta)&&S(this.phi,t.phi)}},{key:\"exactEquals\",value:function(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}},{key:\"set\",value:function(t,e,r){return this.radius=t,this.phi=e,this.theta=r,this.check()}},{key:\"clone\",value:function(){return(new this.constructor).copy(this)}},{key:\"copy\",value:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}},{key:\"fromLngLatZ\",value:function(t){var e=H(t,3),r=e[0],n=e[1],i=e[2];this.radius=1+i/this.radiusScale,this.phi=m(n),this.theta=m(r)}},{key:\"fromVector3\",value:function(t){return this.radius=Te()(t),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos(M(t[2]/this.radius,-1,1))),this.check()}},{key:\"toVector3\",value:function(){return new q(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}},{key:\"makeSafe\",value:function(){this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi))}},{key:\"check\",value:function(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error(\"SphericalCoordinates: some fields set to invalid numbers\");return this}},{key:\"bearing\",get:function(){return 180-b(this.phi)},set:function(t){this.phi=Math.PI-m(t)}},{key:\"pitch\",get:function(){return b(this.theta)},set:function(t){this.theta=m(t)}},{key:\"longitude\",get:function(){return b(this.phi)}},{key:\"latitude\",get:function(){return b(this.theta)}},{key:\"lng\",get:function(){return b(this.phi)}},{key:\"lat\",get:function(){return b(this.theta)}},{key:\"z\",get:function(){return(this.radius-1)*this.radiusScale}}]),t}(),Se=\"Unknown Euler angle order\";var je=function(t){function e(){var t,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.DefaultOrder;(Object(n.a)(this,e),t=a(this,u(e).call(this)),arguments.length>0&&Array.isArray(arguments[0]))?(r=t).fromVector3.apply(r,arguments):t.set(i,o,s,c);return t}return c(e,I),Object(i.a)(e,[{key:\"ELEMENTS\",get:function(){return 4}}],[{key:\"rotationOrder\",value:function(t){return e.RotationOrders[t]}},{key:\"ZYX\",get:function(){return 0}},{key:\"YXZ\",get:function(){return 1}},{key:\"XZY\",get:function(){return 2}},{key:\"ZXY\",get:function(){return 3}},{key:\"YZX\",get:function(){return 4}},{key:\"XYZ\",get:function(){return 5}},{key:\"RollPitchYaw\",get:function(){return 0}},{key:\"DefaultOrder\",get:function(){return e.ZYX}},{key:\"RotationOrders\",get:function(){return[\"ZYX\",\"YXZ\",\"XZY\",\"ZXY\",\"YZX\",\"XYZ\"]}}]),Object(i.a)(e,[{key:\"copy\",value:function(t){for(var e=0;e<3;++e)this[e]=t[e];return this[3]=Number.isFinite(t[3])||this.order,this.check()}},{key:\"set\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0;return this[0]=t,this[1]=e,this[2]=r,this[3]=Number.isFinite(n)?n:this[3],this.check()}},{key:\"validate\",value:function(){return(t=this[3])>=0&&t<6&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2]);var t}},{key:\"toArray\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t}},{key:\"toArray4\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t[e+3]=this[3],t}},{key:\"toVector3\",value:function(t){return t?t.set(this[0],this[1],this[2]):new q(this[0],this[1],this[2])}},{key:\"fromVector3\",value:function(t,e){return this.set(t[0],t[1],t[2],Number.isFinite(e)?e:this[3])}},{key:\"fromArray\",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this[0]=t[0+e],this[1]=t[1+e],this[2]=t[2+e],void 0!==t[3]&&(this[3]=t[3]),this.check()}},{key:\"fromRollPitchYaw\",value:function(t,r,n){return this.set(t,r,n,e.ZYX)}},{key:\"fromQuaternion\",value:function(t,e){return this._fromRotationMatrix(Bt.fromQuaternion(t),e),this.check()}},{key:\"fromRotationMatrix\",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DefaultOrder;return this._fromRotationMatrix(t,r),this.check()}},{key:\"getRotationMatrix\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Bt;return this._getRotationMatrix(t),t}},{key:\"getQuaternion\",value:function(){var t=new _e;switch(this[4]){case e.XYZ:return t.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case e.YXZ:return t.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case e.ZXY:return t.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case e.ZYX:return t.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case e.YZX:return t.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case e.XZY:return t.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(Se)}}},{key:\"_fromRotationMatrix\",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DefaultOrder,n=t.elements,i=n[0],o=n[4],a=n[8],u=n[1],s=n[5],c=n[9],f=n[2],h=n[6],l=n[10];switch(r=r||this[3]){case e.XYZ:this[1]=Math.asin(M(a,-1,1)),Math.abs(a)<.99999?(this[0]=Math.atan2(-c,l),this[2]=Math.atan2(-o,i)):(this[0]=Math.atan2(h,s),this[2]=0);break;case e.YXZ:this[0]=Math.asin(-M(c,-1,1)),Math.abs(c)<.99999?(this[1]=Math.atan2(a,l),this[2]=Math.atan2(u,s)):(this[1]=Math.atan2(-f,i),this[2]=0);break;case e.ZXY:this[0]=Math.asin(M(h,-1,1)),Math.abs(h)<.99999?(this[1]=Math.atan2(-f,l),this[2]=Math.atan2(-o,s)):(this[1]=0,this[2]=Math.atan2(u,i));break;case e.ZYX:this[1]=Math.asin(-M(f,-1,1)),Math.abs(f)<.99999?(this[0]=Math.atan2(h,l),this[2]=Math.atan2(u,i)):(this[0]=0,this[2]=Math.atan2(-o,s));break;case e.YZX:this[2]=Math.asin(M(u,-1,1)),Math.abs(u)<.99999?(this[0]=Math.atan2(-c,s),this[1]=Math.atan2(-f,i)):(this[0]=0,this[1]=Math.atan2(a,l));break;case e.XZY:this[2]=Math.asin(-M(o,-1,1)),Math.abs(o)<.99999?(this[0]=Math.atan2(h,s),this[1]=Math.atan2(a,i)):(this[0]=Math.atan2(-c,l),this[1]=0);break;default:throw new Error(Se)}return this[3]=r,this}},{key:\"_getRotationMatrix\",value:function(){var t=new Bt,r=this.x,n=this.y,i=this.z,o=Math.cos(r),a=Math.cos(n),u=Math.cos(i),s=Math.sin(r),c=Math.sin(n),f=Math.sin(i);switch(this[3]){case e.XYZ:var h=o*u,l=o*f,v=s*u,y=s*f;t[0]=a*u,t[4]=-a*f,t[8]=c,t[1]=l+v*c,t[5]=h-y*c,t[9]=-s*a,t[2]=y-h*c,t[6]=v+l*c,t[10]=o*a;break;case e.YXZ:var g=a*u,d=a*f,p=c*u,m=c*f;t[0]=g+m*s,t[4]=p*s-d,t[8]=o*c,t[1]=o*f,t[5]=o*u,t[9]=-s,t[2]=d*s-p,t[6]=m+g*s,t[10]=o*a;break;case e.ZXY:var b=a*u,E=a*f,k=c*u,w=c*f;t[0]=b-w*s,t[4]=-o*f,t[8]=k+E*s,t[1]=E+k*s,t[5]=o*u,t[9]=w-b*s,t[2]=-o*c,t[6]=s,t[10]=o*a;break;case e.ZYX:var _=o*u,A=o*f,T=s*u,M=s*f;t[0]=a*u,t[4]=T*c-A,t[8]=_*c+M,t[1]=a*f,t[5]=M*c+_,t[9]=A*c-T,t[2]=-c,t[6]=s*a,t[10]=o*a;break;case e.YZX:var O=o*a,S=o*c,j=s*a,I=s*c;t[0]=a*u,t[4]=I-O*f,t[8]=j*f+S,t[1]=f,t[5]=o*u,t[9]=-s*u,t[2]=-c*u,t[6]=S*f+j,t[10]=O-I*f;break;case e.XZY:var x=o*a,P=o*c,R=s*a,L=s*c;t[0]=a*u,t[4]=-f,t[8]=c*u,t[1]=x*f+L,t[5]=o*u,t[9]=P*f-R,t[2]=R*f-P,t[6]=s*u,t[10]=L*f+x;break;default:throw new Error(Se)}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:\"x\",get:function(){return this[0]},set:function(t){return this[0]=l(t)}},{key:\"y\",get:function(){return this[1]},set:function(t){return this[1]=l(t)}},{key:\"z\",get:function(){return this[2]},set:function(t){return this[2]=l(t)}},{key:\"alpha\",get:function(){return this[0]},set:function(t){return this[0]=l(t)}},{key:\"beta\",get:function(){return this[1]},set:function(t){return this[1]=l(t)}},{key:\"gamma\",get:function(){return this[2]},set:function(t){return this[2]=l(t)}},{key:\"phi\",get:function(){return this[0]},set:function(t){return this[0]=l(t)}},{key:\"theta\",get:function(){return this[1]},set:function(t){return this[1]=l(t)}},{key:\"psi\",get:function(){return this[2]},set:function(t){return this[2]=l(t)}},{key:\"roll\",get:function(){return this[0]},set:function(t){return this[0]=l(t)}},{key:\"pitch\",get:function(){return this[1]},set:function(t){return this[1]=l(t)}},{key:\"yaw\",get:function(){return this[2]},set:function(t){return this[2]=l(t)}},{key:\"order\",get:function(){return this[3]},set:function(t){return this[3]=function(t){if(t<0&&t>=6)throw new Error(Se);return t}(t)}}]),e}(),Ie=function(){function t(e){var r=e.x,i=void 0===r?0:r,o=e.y,a=void 0===o?0:o,u=e.z,s=void 0===u?0:u,c=e.roll,f=void 0===c?0:c,h=e.pitch,l=void 0===h?0:h,v=e.yaw,y=void 0===v?0:v,g=e.position,d=e.orientation;Object(n.a)(this,t),Array.isArray(g)&&3===g.length?this.position=new q(g):this.position=new q(i,a,s),Array.isArray(d)&&4===d.length?this.orientation=new je(d,d[3]):this.orientation=new je(f,l,y,je.RollPitchYaw)}return Object(i.a)(t,[{key:\"getPosition\",value:function(){return this.position}},{key:\"getOrientation\",value:function(){return this.orientation}},{key:\"equals\",value:function(t){return!!t&&(this.position.equals(t.position)&&this.orientation.equals(t.orientation))}},{key:\"exactEquals\",value:function(t){return!!t&&(this.position.exactEquals(t.position)&&this.orientation.exactEquals(t.orientation))}},{key:\"getTransformationMatrix\",value:function(){var t=Math.sin(this.roll),e=Math.sin(this.pitch),r=Math.sin(this.yaw),n=Math.cos(this.roll),i=Math.cos(this.pitch),o=Math.cos(this.yaw);return(new Bt).setRowMajor(o*i,-r*n+o*e*t,r*t+o*e*n,this.x,r*i,o*n+r*e*t,-o*t+r*e*n,this.y,-e,i*t,i*n,this.z,0,0,0,1)}},{key:\"getTransformationMatrixFromPose\",value:function(t){return(new Bt).multiplyRight(this.getTransformationMatrix()).multiplyRight(t.getTransformationMatrix().invert())}},{key:\"getTransformationMatrixToPose\",value:function(t){return(new Bt).multiplyRight(t.getTransformationMatrix()).multiplyRight(this.getTransformationMatrix().invert())}},{key:\"x\",get:function(){return this.position.x},set:function(t){return this.position.x=t}},{key:\"y\",get:function(){return this.position.y},set:function(t){return this.position.y=t}},{key:\"z\",get:function(){return this.position.z},set:function(t){return this.position.z=t}},{key:\"roll\",get:function(){return this.orientation.roll},set:function(t){return this.orientation.roll=t}},{key:\"pitch\",get:function(){return this.orientation.pitch},set:function(t){return this.orientation.pitch=t}},{key:\"yaw\",get:function(){return this.orientation.yaw},set:function(t){return this.orientation.yaw=t}}]),t}(),xe=function(){function t(e){Object(n.a)(this,t),this.points=e,this.isClosed=S(this.points[this.points.length-1],this.points[0]),Object.freeze(this)}return Object(i.a)(t,[{key:\"getSignedArea\",value:function(){var t=0;return this.forEachSegment(function(e,r){t+=(e[0]+r[0])*(e[1]-r[1])}),t/2}},{key:\"getArea\",value:function(){return Math.abs(this.getSignedArea())}},{key:\"getWindingDirection\",value:function(){return Math.sign(this.getSignedArea())}},{key:\"forEachSegment\",value:function(t){for(var e=this.points.length,r=0;r<e-1;r++)t(this.points[r],this.points[r+1],r,r+1);this.isPolygon&&!this.isClosed()&&t(this.points[e-1],this.points[0],e-1,0)}}]),t}();r.d(e,\"Vector2\",function(){return B}),r.d(e,\"Vector3\",function(){return q}),r.d(e,\"Vector4\",function(){return J}),r.d(e,\"Matrix4\",function(){return Bt}),r.d(e,\"Quaternion\",function(){return _e}),r.d(e,\"config\",function(){return f}),r.d(e,\"checkNumber\",function(){return l}),r.d(e,\"configure\",function(){return h}),r.d(e,\"formatValue\",function(){return y}),r.d(e,\"isArray\",function(){return g}),r.d(e,\"clone\",function(){return d}),r.d(e,\"radians\",function(){return m}),r.d(e,\"degrees\",function(){return b}),r.d(e,\"sin\",function(){return E}),r.d(e,\"cos\",function(){return k}),r.d(e,\"tan\",function(){return w}),r.d(e,\"asin\",function(){return _}),r.d(e,\"acos\",function(){return A}),r.d(e,\"atan\",function(){return T}),r.d(e,\"clamp\",function(){return M}),r.d(e,\"lerp\",function(){return O}),r.d(e,\"equals\",function(){return S}),r.d(e,\"_SphericalCoordinates\",function(){return Oe}),r.d(e,\"_Pose\",function(){return Ie}),r.d(e,\"_Euler\",function(){return je}),r.d(e,\"_Polygon\",function(){return xe})},function(t,e){t.exports=function(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t}},function(t,e,r){t.exports=function(t,e){var r=n(t[0],t[1],t[2]),a=n(e[0],e[1],e[2]);i(r,r),i(a,a);var u=o(r,a);return u>1?0:Math.acos(u)};var n=r(75),i=r(19),o=r(20)},function(t,e){t.exports=function(t,e,r,n){var i=r[1],o=r[2],a=e[1]-i,u=e[2]-o,s=Math.sin(n),c=Math.cos(n);return t[0]=e[0],t[1]=i+a*c-u*s,t[2]=o+a*s+u*c,t}},function(t,e){t.exports=function(t,e,r,n){var i=r[0],o=r[2],a=e[0]-i,u=e[2]-o,s=Math.sin(n),c=Math.cos(n);return t[0]=i+u*s+a*c,t[1]=e[1],t[2]=o+u*c-a*s,t}},function(t,e){t.exports=function(t,e,r,n){var i=r[0],o=r[1],a=e[0]-i,u=e[1]-o,s=Math.sin(n),c=Math.cos(n);return t[0]=i+a*c-u*s,t[1]=o+a*s+u*c,t[2]=e[2],t}},function(t,e){t.exports=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],c=t[8],f=t[9],h=t[10],l=t[11],v=t[12],y=t[13],g=t[14],d=t[15];return(e*a-r*o)*(h*d-l*g)-(e*u-n*o)*(f*d-l*y)+(e*s-i*o)*(f*g-h*y)+(r*u-n*a)*(c*d-l*v)-(r*s-i*a)*(c*g-h*v)+(n*s-i*u)*(c*y-f*v)}},function(t,e){t.exports=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r+r,u=n+n,s=i+i,c=r*a,f=n*a,h=n*u,l=i*a,v=i*u,y=i*s,g=o*a,d=o*u,p=o*s;return t[0]=1-h-y,t[1]=f+p,t[2]=l-d,t[3]=0,t[4]=f-p,t[5]=1-c-y,t[6]=v+g,t[7]=0,t[8]=l+d,t[9]=v-g,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t,e,r,n,i,o,a){var u=1/(r-e),s=1/(i-n),c=1/(o-a);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*s,t[6]=0,t[7]=0,t[8]=(r+e)*u,t[9]=(i+n)*s,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}},function(t,e,r){var n=r(76);t.exports=function(t,e,r,i){var o,a,u,s,c,f,h,l,v,y,g=e[0],d=e[1],p=e[2],m=i[0],b=i[1],E=i[2],k=r[0],w=r[1],_=r[2];if(Math.abs(g-k)<1e-6&&Math.abs(d-w)<1e-6&&Math.abs(p-_)<1e-6)return n(t);h=g-k,l=d-w,v=p-_,y=1/Math.sqrt(h*h+l*l+v*v),o=b*(v*=y)-E*(l*=y),a=E*(h*=y)-m*v,u=m*l-b*h,(y=Math.sqrt(o*o+a*a+u*u))?(o*=y=1/y,a*=y,u*=y):(o=0,a=0,u=0);s=l*u-v*a,c=v*o-h*u,f=h*a-l*o,(y=Math.sqrt(s*s+c*c+f*f))?(s*=y=1/y,c*=y,f*=y):(s=0,c=0,f=0);return t[0]=o,t[1]=s,t[2]=h,t[3]=0,t[4]=a,t[5]=c,t[6]=l,t[7]=0,t[8]=u,t[9]=f,t[10]=v,t[11]=0,t[12]=-(o*g+a*d+u*p),t[13]=-(s*g+c*d+f*p),t[14]=-(h*g+l*d+v*p),t[15]=1,t}},function(t,e){t.exports=function(t,e,r,n,i,o,a){var u=1/(e-r),s=1/(n-i),c=1/(o-a);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*u,t[13]=(i+n)*s,t[14]=(a+o)*c,t[15]=1,t}},function(t,e){t.exports=function(t,e,r,n,i){var o=1/Math.tan(e/2),a=1/(n-i);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+n)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*n*a,t[15]=0,t}},function(t,e){t.exports=function(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],o=e[6],a=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}},function(t,e){t.exports=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],h=e[9],l=e[10],v=e[11],y=e[12],g=e[13],d=e[14],p=e[15],m=r*u-n*a,b=r*s-i*a,E=r*c-o*a,k=n*s-i*u,w=n*c-o*u,_=i*c-o*s,A=f*g-h*y,T=f*d-l*y,M=f*p-v*y,O=h*d-l*g,S=h*p-v*g,j=l*p-v*d,I=m*j-b*S+E*O+k*M-w*T+_*A;if(!I)return null;return I=1/I,t[0]=(u*j-s*S+c*O)*I,t[1]=(i*S-n*j-o*O)*I,t[2]=(g*_-d*w+p*k)*I,t[3]=(l*w-h*_-v*k)*I,t[4]=(s*M-a*j-c*T)*I,t[5]=(r*j-i*M+o*T)*I,t[6]=(d*E-y*_-p*b)*I,t[7]=(f*_-l*E+v*b)*I,t[8]=(a*S-u*M+c*A)*I,t[9]=(n*M-r*S-o*A)*I,t[10]=(y*w-g*E+p*m)*I,t[11]=(h*E-f*w-v*m)*I,t[12]=(u*T-a*O-s*A)*I,t[13]=(r*O-n*T+i*A)*I,t[14]=(g*b-y*k-d*m)*I,t[15]=(f*k-h*b+l*m)*I,t}},function(t,e){t.exports=function(t,e,r,n){var i,o,a,u,s,c,f,h,l,v,y,g,d,p,m,b,E,k,w,_,A,T,M,O,S=n[0],j=n[1],I=n[2],x=Math.sqrt(S*S+j*j+I*I);if(Math.abs(x)<1e-6)return null;S*=x=1/x,j*=x,I*=x,i=Math.sin(r),o=Math.cos(r),a=1-o,u=e[0],s=e[1],c=e[2],f=e[3],h=e[4],l=e[5],v=e[6],y=e[7],g=e[8],d=e[9],p=e[10],m=e[11],b=S*S*a+o,E=j*S*a+I*i,k=I*S*a-j*i,w=S*j*a-I*i,_=j*j*a+o,A=I*j*a+S*i,T=S*I*a+j*i,M=j*I*a-S*i,O=I*I*a+o,t[0]=u*b+h*E+g*k,t[1]=s*b+l*E+d*k,t[2]=c*b+v*E+p*k,t[3]=f*b+y*E+m*k,t[4]=u*w+h*_+g*A,t[5]=s*w+l*_+d*A,t[6]=c*w+v*_+p*A,t[7]=f*w+y*_+m*A,t[8]=u*T+h*M+g*O,t[9]=s*T+l*M+d*O,t[10]=c*T+v*M+p*O,t[11]=f*T+y*M+m*O,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t}},function(t,e){t.exports=function(t,e,r){var n=r[0],i=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},function(t,e){t.exports=function(t,e,r){var n,i,o,a,u,s,c,f,h,l,v,y,g=r[0],d=r[1],p=r[2];e===t?(t[12]=e[0]*g+e[4]*d+e[8]*p+e[12],t[13]=e[1]*g+e[5]*d+e[9]*p+e[13],t[14]=e[2]*g+e[6]*d+e[10]*p+e[14],t[15]=e[3]*g+e[7]*d+e[11]*p+e[15]):(n=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],h=e[8],l=e[9],v=e[10],y=e[11],t[0]=n,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=c,t[7]=f,t[8]=h,t[9]=l,t[10]=v,t[11]=y,t[12]=n*g+u*d+h*p+e[12],t[13]=i*g+s*d+l*p+e[13],t[14]=o*g+c*d+v*p+e[14],t[15]=a*g+f*d+y*p+e[15]);return t}},function(t,e){t.exports=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}},function(t,e){t.exports=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[3]*n+r[7]*i+r[11]*o+r[15];return a=a||1,t[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/a,t[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/a,t[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/a,t}},function(t,e){t.exports=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[4],a=e[5],u=e[6],s=e[7],c=e[8],f=e[9],h=e[10],l=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[4]=o*i+c*n,t[5]=a*i+f*n,t[6]=u*i+h*n,t[7]=s*i+l*n,t[8]=c*i-o*n,t[9]=f*i-a*n,t[10]=h*i-u*n,t[11]=l*i-s*n,t}},function(t,e){t.exports=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],u=e[2],s=e[3],c=e[8],f=e[9],h=e[10],l=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*i-c*n,t[1]=a*i-f*n,t[2]=u*i-h*n,t[3]=s*i-l*n,t[8]=o*n+c*i,t[9]=a*n+f*i,t[10]=u*n+h*i,t[11]=s*n+l*i,t}},function(t,e){t.exports=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],u=e[2],s=e[3],c=e[4],f=e[5],h=e[6],l=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*i+c*n,t[1]=a*i+f*n,t[2]=u*i+h*n,t[3]=s*i+l*n,t[4]=c*i-o*n,t[5]=f*i-a*n,t[6]=h*i-u*n,t[7]=l*i-s*n,t}},function(t,e){t.exports=function(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*o+a]-e[3*a+o])*r,t[o]=(e[3*o+i]+e[3*i+o])*r,t[a]=(e[3*a+i]+e[3*i+a])*r}return t}},function(t,e){t.exports=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}},function(t,e,r){t.exports=r(77)},function(t,e,r){t.exports=r(78)},function(t,e,r){t.exports=r(79)},function(t,e,r){var n=r(20),i=r(14),o=r(15),a=r(19),u=r(16),s=r(17);t.exports=function(t,e,r){var l=n(e,r);return l<-.999999?(i(c,f,e),o(c)<1e-6&&i(c,h,e),a(c,c),s(t,c,Math.PI),t):l>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(i(c,e,r),t[0]=c[0],t[1]=c[1],t[2]=c[2],t[3]=1+l,u(t,t))};var c=[0,0,0],f=[1,0,0],h=[0,1,0]},function(t,e,r){t.exports=r(81)},function(t,e){t.exports=function(t,e){var r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t}},function(t,e){t.exports=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}},function(t,e){t.exports=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o,u=a?1/a:0;return t[0]=-r*u,t[1]=-n*u,t[2]=-i*u,t[3]=o*u,t}},function(t,e,r){t.exports=r(82)},function(t,e){t.exports=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=r[0],s=r[1],c=r[2],f=r[3];return t[0]=n*f+a*u+i*c-o*s,t[1]=i*f+a*s+o*u-n*c,t[2]=o*f+a*c+n*s-i*u,t[3]=a*f-n*u-i*s-o*c,t}},function(t,e){t.exports=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s+a*u,t[1]=i*s+o*u,t[2]=o*s-i*u,t[3]=a*s-n*u,t}},function(t,e){t.exports=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s-o*u,t[1]=i*s+a*u,t[2]=o*s+n*u,t[3]=a*s-i*u,t}},function(t,e){t.exports=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s+i*u,t[1]=i*s-n*u,t[2]=o*s+a*u,t[3]=a*s-o*u,t}},function(t,e,r){t.exports=r(83)},function(t,e,r){t.exports=r(84)},function(t,e){t.exports=function(t,e,r,n){var i,o,a,u,s,c=e[0],f=e[1],h=e[2],l=e[3],v=r[0],y=r[1],g=r[2],d=r[3];(o=c*v+f*y+h*g+l*d)<0&&(o=-o,v=-v,y=-y,g=-g,d=-d);1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),u=Math.sin((1-n)*i)/a,s=Math.sin(n*i)/a):(u=1-n,s=n);return t[0]=u*c+s*v,t[1]=u*f+s*y,t[2]=u*h+s*g,t[3]=u*l+s*d,t}},function(t,e,r){\"use strict\";function n(t,e){if(!t)throw new Error(e||\"loader assertion failed.\")}r.d(e,\"a\",function(){return n})},function(t,e,r){\"undefined\"==typeof TextDecoder?t.exports=r(89):t.exports={TextEncoder:TextEncoder,TextDecoder:TextDecoder}},function(t,e,r){\"use strict\";function n(t){return t+3&-4}function i(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.byteLength,i=new Uint8Array(t,r,n),o=new Uint8Array(e);return i.set(o),t}r.d(e,\"b\",function(){return n}),r.d(e,\"a\",function(){return i})},function(t,e,r){\"use strict\";var n;(0,((n=r(73))&&n.__esModule?n:{default:n}).default)({})(self)},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=void 0;var n=r(4),i=r(87),o=r(103),a=r(104),u=r(7);e.default=function(t){return function(e){function r(t){var r=new Set;switch(t.type){case u.LOG_STREAM_MESSAGE.TIMESLICE:for(var n in t.streams){var i=t.streams[n];(0,a.getTransferList)(i.pointCloud,!0,r),i.images&&i.images.length&&i.images.forEach(function(t){return(0,a.getTransferList)(t,!0,r)})}break;case u.LOG_STREAM_MESSAGE.VIDEO_FRAME:(0,a.getTransferList)(t.imageData,!1,r)}t=(0,o.preSerialize)(t),e.postMessage(t,Array.from(r))}function s(t){throw t}(0,n.setXVIZConfig)(t),e.onmessage=function(t){t.data&&t.data.xvizConfig?(0,n.setXVIZConfig)(t.data.xvizConfig):t.data&&(0,i.parseStreamDataMessage)(t.data,r,s)}}}},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=void 0;var n,i=(n=r(11))&&n.__esModule?n:{default:n};function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).ObjectType,r=void 0===e?i.default:e;!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.objects=new Map,this.ObjectType=r}var e,r,n;return e=t,(r=[{key:\"clear\",value:function(){this.objects.clear()}},{key:\"count\",value:function(){return this.objects.size}},{key:\"observe\",value:function(t,e){if(null!=t)if(t=t.toString(),this.objects.has(t)){this.objects.get(t)._observe(e)}else{var r=new this.ObjectType({id:t,timestamp:e});this.objects.set(t,r)}}},{key:\"get\",value:function(t){return null==t?null:(t=t.toString(),this.objects.get(t)||null)}},{key:\"resetAll\",value:function(){this.objects.forEach(function(t){return t._reset()})}},{key:\"getAll\",value:function(){var t={};return this.objects.forEach(function(e,r){t[r]=e}),t}},{key:\"getAllInCurrentFrame\",value:function(){var t={};return this.objects.forEach(function(e,r){e.isValid&&(t[r]=e)}),t}},{key:\"prune\",value:function(t,e){var r=this.objects,n=[];r.forEach(function(r,i){(r.endTime<t||r.startTime>e)&&n.push(i)}),n.forEach(function(t){r.delete(t)})}}])&&o(e.prototype,r),n&&o(e,n),t}();e.default=a},function(t,e){t.exports=function(t,e,r){var n=new Float32Array(3);return n[0]=t,n[1]=e,n[2]=r,n}},function(t,e){t.exports=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.sqrt(e*e+r*r+n*n+i*i)}},function(t,e){t.exports=function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}},function(t,e){t.exports=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}},function(t,e){t.exports=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o;a>0&&(a=1/Math.sqrt(a),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=o*a);return t}},function(t,e){t.exports=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}},function(t,e){t.exports=function(t,e,r,n){var i=e[0],o=e[1],a=e[2],u=e[3];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=a+n*(r[2]-a),t[3]=u+n*(r[3]-u),t}},function(t,e){t.exports=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}},function(t,e){t.exports=function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}},function(t,e,r){\"use strict\";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=void 0;var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t)}var e,r,i;return e=t,(r=[{key:\"isValid\",get:function(){return!1}},{key:\"position\",get:function(){return null}},{key:\"bearing\",get:function(){return null}}])&&n(e.prototype,r),i&&n(e,i),t}();e.default=i},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.getCentroid=function(t){var e=0,r=0,n=0,i=t.length;if(1===i)return t[0];t[0]===t[i-1]&&(i-=1);for(var o=0;o<i;o++){var a=t[o];e+=a[0],r+=a[1],n+=a[2]||0}return[e/i,r/i,n/i]}},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.unpackEnvelope=g,e.isEnvelope=d,e.parseStreamDataMessage=function(t,e,r,n){if(\"undefined\"!=typeof Blob&&t instanceof Blob)return void(0,a.parseStreamVideoMessage)(t,e,r);try{var o,s;o=\"string\"==typeof t?JSON.parse(t):function t(e,r){if(e){if((0,i.isBinaryXVIZ)(e))return(0,i.parseBinaryXVIZ)(e);if(e instanceof Uint8Array&&(a=e,s=String.fromCharCode(a[0]),c=String.fromCharCode(a[a.length-1]),\"{\"===s&&\"}\"===c||\"[\"===s&&\"]\"===c)){var n=new u.TextDecoder(\"utf8\").decode(e);return JSON.parse(n)}if(r&&\"object\"===y(e))for(var o in e)e[o]=t(e[o],!1)}else;var a,s,c;return e}(t,!0);var c=!0;if(d(o)){var f=g(o);\"xviz\"===f.namespace?(s=f.type,o=f.data):c=!1}if(c){var h=p(o,l({},n,{v2Type:s}));e(h)}}catch(t){r(t)}},e.parseStreamLogData=p;var n=r(7),i=r(88),o=r(23),a=r(93),u=r(25),s=h(r(96)),c=h(r(101)),f=r(4);function h(t){return t&&t.__esModule?t:{default:t}}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){v(t,e,r[e])})}return t}function v(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y(t){return(y=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function g(t){var e=t.type.split(\"/\");return{namespace:e[0],type:e.slice(1).join(\"/\"),data:t.data}}function d(t){return t.type&&t.data}function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e.v2Type||t.type||t.message||t.update_type){case\"state_update\":return m(t,e.convertPrimitive);case\"metadata\":return l({},(0,o.parseLogMetadata)(t),{type:n.LOG_STREAM_MESSAGE.METADATA});case\"transform_log_done\":return l({},t,{type:n.LOG_STREAM_MESSAGE.DONE});case\"error\":return l({},t,{message:\"Stream server error\",type:n.LOG_STREAM_MESSAGE.ERROR});case\"done\":return l({},t,{type:n.LOG_STREAM_MESSAGE.DONE});default:return m(t,e.convertPrimitive)}}function m(t,e){return 1===(0,f.getXVIZConfig)().currentMajorVersion?(0,s.default)(t,e):(0,c.default)(t,e)}},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.parseBinaryXVIZ=function(t){var e=new n.GLTFParser;return e.parse(t,{createImages:!1}),e.getApplicationData(\"xviz\")},e.isBinaryXVIZ=function(t){return t instanceof ArrayBuffer&&function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).magic,r=void 0===e?o:e,n=new DataView(t).getUint32(0,a);return n===r||n===o}(t,{magic:i})};var n=r(105),i=1482049882,o=1735152710,a=!1},function(t,e){},function(t,e,r){\"use strict\";(function(t){\n/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\nvar n=r(22),i=r(91),o=r(92);function a(){return s.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,e){if(a()<e)throw new RangeError(\"Invalid typed array length\");return s.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=s.prototype:(null===t&&(t=new s(e)),t.length=e),t}function s(t,e,r){if(!(s.TYPED_ARRAY_SUPPORT||this instanceof s))return new s(t,e,r);if(\"number\"==typeof t){if(\"string\"==typeof e)throw new Error(\"If encoding is specified then the first argument must be a string\");return h(this,t)}return c(this,t,e,r)}function c(t,e,r,n){if(\"number\"==typeof e)throw new TypeError('\"value\" argument must not be a number');return\"undefined\"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError(\"'offset' is out of bounds\");if(e.byteLength<r+(n||0))throw new RangeError(\"'length' is out of bounds\");e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);s.TYPED_ARRAY_SUPPORT?(t=e).__proto__=s.prototype:t=l(t,e);return t}(t,e,r,n):\"string\"==typeof e?function(t,e,r){\"string\"==typeof r&&\"\"!==r||(r=\"utf8\");if(!s.isEncoding(r))throw new TypeError('\"encoding\" must be a valid string encoding');var n=0|y(e,r),i=(t=u(t,n)).write(e,r);i!==n&&(t=t.slice(0,i));return t}(t,e,r):function(t,e){if(s.isBuffer(e)){var r=0|v(e.length);return 0===(t=u(t,r)).length?t:(e.copy(t,0,0,r),t)}if(e){if(\"undefined\"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||\"length\"in e)return\"number\"!=typeof e.length||(n=e.length)!=n?u(t,0):l(t,e);if(\"Buffer\"===e.type&&o(e.data))return l(t,e.data)}var n;throw new TypeError(\"First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.\")}(t,e)}function f(t){if(\"number\"!=typeof t)throw new TypeError('\"size\" argument must be a number');if(t<0)throw new RangeError('\"size\" argument must not be negative')}function h(t,e){if(f(e),t=u(t,e<0?0:0|v(e)),!s.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function l(t,e){var r=e.length<0?0:0|v(e.length);t=u(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function v(t){if(t>=a())throw new RangeError(\"Attempt to allocate Buffer larger than maximum size: 0x\"+a().toString(16)+\" bytes\");return 0|t}function y(t,e){if(s.isBuffer(t))return t.length;if(\"undefined\"!=typeof ArrayBuffer&&\"function\"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;\"string\"!=typeof t&&(t=\"\"+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case\"ascii\":case\"latin1\":case\"binary\":return r;case\"utf8\":case\"utf-8\":case void 0:return D(t).length;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return 2*r;case\"hex\":return r>>>1;case\"base64\":return F(t).length;default:if(n)return D(t).length;e=(\"\"+e).toLowerCase(),n=!0}}function g(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function d(t,e,r,n,i){if(0===t.length)return-1;if(\"string\"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if(\"string\"==typeof e&&(e=s.from(e,n)),s.isBuffer(e))return 0===e.length?-1:p(t,e,r,n,i);if(\"number\"==typeof e)return e&=255,s.TYPED_ARRAY_SUPPORT&&\"function\"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):p(t,[e],r,n,i);throw new TypeError(\"val must be string, number or Buffer\")}function p(t,e,r,n,i){var o,a=1,u=t.length,s=e.length;if(void 0!==n&&(\"ucs2\"===(n=String(n).toLowerCase())||\"ucs-2\"===n||\"utf16le\"===n||\"utf-16le\"===n)){if(t.length<2||e.length<2)return-1;a=2,u/=2,s/=2,r/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var f=-1;for(o=r;o<u;o++)if(c(t,o)===c(e,-1===f?0:o-f)){if(-1===f&&(f=o),o-f+1===s)return f*a}else-1!==f&&(o-=o-f),f=-1}else for(r+s>u&&(r=u-s),o=r;o>=0;o--){for(var h=!0,l=0;l<s;l++)if(c(t,o+l)!==c(e,l)){h=!1;break}if(h)return o}return-1}function m(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=e.length;if(o%2!=0)throw new TypeError(\"Invalid hex string\");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var u=parseInt(e.substr(2*a,2),16);if(isNaN(u))return a;t[r+a]=u}return a}function b(t,e,r,n){return Y(D(e,t.length-r),t,r,n)}function E(t,e,r,n){return Y(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function k(t,e,r,n){return E(t,e,r,n)}function w(t,e,r,n){return Y(F(e),t,r,n)}function _(t,e,r,n){return Y(function(t,e){for(var r,n,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)r=t.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function A(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function T(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,a,u,s,c=t[i],f=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=r)switch(h){case 1:c<128&&(f=c);break;case 2:128==(192&(o=t[i+1]))&&(s=(31&c)<<6|63&o)>127&&(f=s);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(s=(15&c)<<12|(63&o)<<6|63&a)>2047&&(s<55296||s>57343)&&(f=s);break;case 4:o=t[i+1],a=t[i+2],u=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&u)&&(s=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&u)>65535&&s<1114112&&(f=s)}null===f?(f=65533,h=1):f>65535&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|1023&f),n.push(f),i+=h}return function(t){var e=t.length;if(e<=M)return String.fromCharCode.apply(String,t);var r=\"\",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=M));return r}(n)}e.Buffer=s,e.SlowBuffer=function(t){+t!=t&&(t=0);return s.alloc(+t)},e.INSPECT_MAX_BYTES=50,s.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&\"function\"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),s.poolSize=8192,s._augment=function(t){return t.__proto__=s.prototype,t},s.from=function(t,e,r){return c(null,t,e,r)},s.TYPED_ARRAY_SUPPORT&&(s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,\"undefined\"!=typeof Symbol&&Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0})),s.alloc=function(t,e,r){return function(t,e,r,n){return f(e),e<=0?u(t,e):void 0!==r?\"string\"==typeof n?u(t,e).fill(r,n):u(t,e).fill(r):u(t,e)}(null,t,e,r)},s.allocUnsafe=function(t){return h(null,t)},s.allocUnsafeSlow=function(t){return h(null,t)},s.isBuffer=function(t){return!(null==t||!t._isBuffer)},s.compare=function(t,e){if(!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError(\"Arguments must be Buffers\");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"latin1\":case\"binary\":case\"base64\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return!0;default:return!1}},s.concat=function(t,e){if(!o(t))throw new TypeError('\"list\" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=s.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var a=t[r];if(!s.isBuffer(a))throw new TypeError('\"list\" argument must be an Array of Buffers');a.copy(n,i),i+=a.length}return n},s.byteLength=y,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError(\"Buffer size must be a multiple of 16-bits\");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},s.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError(\"Buffer size must be a multiple of 32-bits\");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},s.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError(\"Buffer size must be a multiple of 64-bits\");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},s.prototype.toString=function(){var t=0|this.length;return 0===t?\"\":0===arguments.length?T(this,0,t):function(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return\"\";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return\"\";if((r>>>=0)<=(e>>>=0))return\"\";for(t||(t=\"utf8\");;)switch(t){case\"hex\":return j(this,e,r);case\"utf8\":case\"utf-8\":return T(this,e,r);case\"ascii\":return O(this,e,r);case\"latin1\":case\"binary\":return S(this,e,r);case\"base64\":return A(this,e,r);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return I(this,e,r);default:if(n)throw new TypeError(\"Unknown encoding: \"+t);t=(t+\"\").toLowerCase(),n=!0}}.apply(this,arguments)},s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError(\"Argument must be a Buffer\");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){var t=\"\",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString(\"hex\",0,r).match(/.{2}/g).join(\" \"),this.length>r&&(t+=\" ... \")),\"<Buffer \"+t+\">\"},s.prototype.compare=function(t,e,r,n,i){if(!s.isBuffer(t))throw new TypeError(\"Argument must be a Buffer\");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError(\"out of range index\");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0),u=Math.min(o,a),c=this.slice(n,i),f=t.slice(e,r),h=0;h<u;++h)if(c[h]!==f[h]){o=c[h],a=f[h];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},s.prototype.indexOf=function(t,e,r){return d(this,t,e,r,!0)},s.prototype.lastIndexOf=function(t,e,r){return d(this,t,e,r,!1)},s.prototype.write=function(t,e,r,n){if(void 0===e)n=\"utf8\",r=this.length,e=0;else if(void 0===r&&\"string\"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error(\"Buffer.write(string, encoding, offset[, length]) is no longer supported\");e|=0,isFinite(r)?(r|=0,void 0===n&&(n=\"utf8\")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError(\"Attempt to write outside buffer bounds\");n||(n=\"utf8\");for(var o=!1;;)switch(n){case\"hex\":return m(this,t,e,r);case\"utf8\":case\"utf-8\":return b(this,t,e,r);case\"ascii\":return E(this,t,e,r);case\"latin1\":case\"binary\":return k(this,t,e,r);case\"base64\":return w(this,t,e,r);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return _(this,t,e,r);default:if(o)throw new TypeError(\"Unknown encoding: \"+n);n=(\"\"+n).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:\"Buffer\",data:Array.prototype.slice.call(this._arr||this,0)}};var M=4096;function O(t,e,r){var n=\"\";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function S(t,e,r){var n=\"\";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function j(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i=\"\",o=e;o<r;++o)i+=N(t[o]);return i}function I(t,e,r){for(var n=t.slice(e,r),i=\"\",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function x(t,e,r){if(t%1!=0||t<0)throw new RangeError(\"offset is not uint\");if(t+e>r)throw new RangeError(\"Trying to access beyond buffer length\")}function P(t,e,r,n,i,o){if(!s.isBuffer(t))throw new TypeError('\"buffer\" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('\"value\" argument is out of bounds');if(r+n>t.length)throw new RangeError(\"Index out of range\")}function R(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);i<o;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function L(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);i<o;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function B(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError(\"Index out of range\");if(r<0)throw new RangeError(\"Index out of range\")}function C(t,e,r,n,o){return o||B(t,0,r,4),i.write(t,e,r,n,23,4),r+4}function V(t,e,r,n,o){return o||B(t,0,r,8),i.write(t,e,r,n,52,8),r+8}s.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),s.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=s.prototype;else{var i=e-t;r=new s(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+t]}return r},s.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||x(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},s.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||x(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},s.prototype.readUInt8=function(t,e){return e||x(t,1,this.length),this[t]},s.prototype.readUInt16LE=function(t,e){return e||x(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUInt16BE=function(t,e){return e||x(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUInt32LE=function(t,e){return e||x(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUInt32BE=function(t,e){return e||x(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||x(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},s.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||x(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},s.prototype.readInt8=function(t,e){return e||x(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){e||x(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(t,e){e||x(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(t,e){return e||x(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return e||x(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readFloatLE=function(t,e){return e||x(t,4,this.length),i.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return e||x(t,4,this.length),i.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return e||x(t,8,this.length),i.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return e||x(t,8,this.length),i.read(this,t,!1,52,8)},s.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||P(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},s.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||P(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},s.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,1,255,0),s.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},s.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},s.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},s.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):L(this,t,e,!0),e+4},s.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):L(this,t,e,!1),e+4},s.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);P(this,t,e,r,i-1,-i)}var o=0,a=1,u=0;for(this[e]=255&t;++o<r&&(a*=256);)t<0&&0===u&&0!==this[e+o-1]&&(u=1),this[e+o]=(t/a>>0)-u&255;return e+r},s.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);P(this,t,e,r,i-1,-i)}var o=r-1,a=1,u=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===u&&0!==this[e+o+1]&&(u=1),this[e+o]=(t/a>>0)-u&255;return e+r},s.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,1,127,-128),s.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},s.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},s.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,4,2147483647,-2147483648),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):L(this,t,e,!0),e+4},s.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):L(this,t,e,!1),e+4},s.prototype.writeFloatLE=function(t,e,r){return C(this,t,e,!0,r)},s.prototype.writeFloatBE=function(t,e,r){return C(this,t,e,!1,r)},s.prototype.writeDoubleLE=function(t,e,r){return V(this,t,e,!0,r)},s.prototype.writeDoubleBE=function(t,e,r){return V(this,t,e,!1,r)},s.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError(\"targetStart out of bounds\");if(r<0||r>=this.length)throw new RangeError(\"sourceStart out of bounds\");if(n<0)throw new RangeError(\"sourceEnd out of bounds\");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,o=n-r;if(this===t&&r<e&&e<n)for(i=o-1;i>=0;--i)t[i+e]=this[i+r];else if(o<1e3||!s.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+o),e);return o},s.prototype.fill=function(t,e,r,n){if(\"string\"==typeof t){if(\"string\"==typeof e?(n=e,e=0,r=this.length):\"string\"==typeof r&&(n=r,r=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&\"string\"!=typeof n)throw new TypeError(\"encoding must be a string\");if(\"string\"==typeof n&&!s.isEncoding(n))throw new TypeError(\"Unknown encoding: \"+n)}else\"number\"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError(\"Out of range index\");if(r<=e)return this;var o;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),\"number\"==typeof t)for(o=e;o<r;++o)this[o]=t;else{var a=s.isBuffer(t)?t:D(new s(t,n).toString()),u=a.length;for(o=0;o<r-e;++o)this[o+e]=a[o%u]}return this};var U=/[^+\\/0-9A-Za-z-_]/g;function N(t){return t<16?\"0\"+t.toString(16):t.toString(16)}function D(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],a=0;a<n;++a){if((r=t.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error(\"Invalid code point\");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function F(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\\s+|\\s+$/g,\"\")}(t).replace(U,\"\")).length<2)return\"\";for(;t.length%4!=0;)t+=\"=\";return t}(t))}function Y(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}}).call(this,r(21))},function(t,e){e.read=function(t,e,r,n,i){var o,a,u=8*i-n-1,s=(1<<u)-1,c=s>>1,f=-7,h=r?i-1:0,l=r?-1:1,v=t[e+h];for(h+=l,o=v&(1<<-f)-1,v>>=-f,f+=u;f>0;o=256*o+t[e+h],h+=l,f-=8);for(a=o&(1<<-f)-1,o>>=-f,f+=n;f>0;a=256*a+t[e+h],h+=l,f-=8);if(0===o)o=1-c;else{if(o===s)return a?NaN:1/0*(v?-1:1);a+=Math.pow(2,n),o-=c}return(v?-1:1)*a*Math.pow(2,o-n)},e.write=function(t,e,r,n,i,o){var a,u,s,c=8*o-i-1,f=(1<<c)-1,h=f>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,v=n?0:o-1,y=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,a=f):(a=Math.floor(Math.log(e)/Math.LN2),e*(s=Math.pow(2,-a))<1&&(a--,s*=2),(e+=a+h>=1?l/s:l*Math.pow(2,1-h))*s>=2&&(a++,s/=2),a+h>=f?(u=0,a=f):a+h>=1?(u=(e*s-1)*Math.pow(2,i),a+=h):(u=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[r+v]=255&u,v+=y,u/=256,i-=8);for(a=a<<i|u,c+=i;c>0;t[r+v]=255&a,v+=y,a/=256,c-=8);t[r+v-y]|=128*g}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return\"[object Array]\"==r.call(t)}},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.parseStreamVideoMessage=function t(e,r,n){if(e instanceof Blob)return void(0,o.blobToArrayBuffer)(e).then(function(e){t(e,r,n)}).catch(n);try{var i=e;\"string\"==typeof e&&(i=JSON.parse(e));var a=u(i);r(a)}catch(t){n(t)}},e.parseStreamVideoData=u,e.parseVideoFrame=s;var n=r(7),i=r(25),o=r(95),a=r(23);function u(t){return t instanceof ArrayBuffer?s(t):\"metadata\"===t.type?function(t){var e=(0,a.parseLogMetadata)(t);return e.type=n.LOG_STREAM_MESSAGE.VIDEO_METADATA,e}(t):{type:n.LOG_STREAM_MESSAGE.ERROR,message:\"Unknown stream data type\",data:t}}function s(t){var e=new DataView(t),r={type:n.LOG_STREAM_MESSAGE.VIDEO_FRAME},o=new i.TextDecoder(\"utf-8\"),a=0;r.version=e.getUint32(a,!0),a+=4,r.versionFlags=e.getUint32(a,!0);var u=(a+=4)+4;a+=4+e.getUint32(a,!0),r.stream=o.decode(t.slice(u,a)),r.timestamp=e.getFloat64(a,!0),a+=8;var s=e.getUint32(a,!0);return a+=4,r.imageData=t.slice(a,a+s),r.imageType=\"image/jpeg\",r}},function(t,e){},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.blobToArrayBuffer=function(t){return new Promise(function(e,r){var n,i=new FileReader;i.onload=function(t){n=t.target.result},i.onloadend=function(t){return e(n)},i.onerror=r,i.readAsArrayBuffer(t)})}},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=function(t,e){var r,u=(0,n.getXVIZConfig)().PRIMARY_POSE_STREAM,s=t.vehicle_pose,c=t.state_updates,f=function(t,e){if(null==t)return{};var r,n,i=function(t,e){if(null==t)return{};var r,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(i[r]=t[r]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}(t,[\"vehicle_pose\",\"state_updates\"]);s?r=s.time:c&&(r=c.reduce(function(t,e){return Math.max(t,e.timestamp)},0));if(!r)return{type:i.LOG_STREAM_MESSAGE.INCOMPLETE};var h={},l=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){a(t,e,r[e])})}return t}({},f,{type:i.LOG_STREAM_MESSAGE.TIMESLICE,streams:h,timestamp:r});if(c){var v=function(t,e,r){var i=(0,n.getXVIZConfig)().STREAM_BLACKLIST,a={},u={},s={},c={},f=!0,h=!1,l=void 0;try{for(var v,y=t[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value;Object.assign(u,g.primitives),Object.assign(s,g.variables),Object.assign(c,g.futures)}}catch(t){h=!0,l=t}finally{try{f||null==y.return||y.return()}finally{if(h)throw l}}return Object.keys(u).filter(function(t){return!i.has(t)}).forEach(function(t){a[t]=(0,o.parseStreamPrimitive)(u[t],t,e,r)}),Object.keys(s).filter(function(t){return!i.has(t)}).forEach(function(t){a[t]=(0,o.parseStreamVariable)(s[t],t,e)}),Object.keys(c).filter(function(t){return!i.has(t)}).forEach(function(t){a[t]=(0,o.parseStreamFutures)(c[t],t,e,r)}),a}(c,r,e);Object.assign(h,v)}s&&(h[u]=s);return l};var n=r(4),i=r(7),o=r(26);function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.isMainThread=void 0;var n=\"undefined\"!=typeof document;e.isMainThread=n},function(t,e){},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=void 0;var n=r(28),i=r(12),o={text:{category:i.PRIMITIVE_CAT.LABEL,validate:function(t){return!0}},tree_table:{category:i.PRIMITIVE_CAT.COMPONENT,validate:function(t){return!0}},points3d:{category:i.PRIMITIVE_CAT.POINTCLOUD,validate:function(t,e,r){return t.vertices&&t.vertices.length>0}},points2d:{category:i.PRIMITIVE_CAT.FEATURE,validate:function(t,e,r){return t.vertices&&t.vertices.length>0},normalize:function(t){for(var e=0;e<t.vertices.length;e++)t.vertices[e][2]=0}},point2d:{category:i.PRIMITIVE_CAT.FEATURE,enableZOffSet:!0,validate:function(t,e,r){return t.vertices&&1===t.vertices.length},normalize:function(t){t.vertices=t.vertices[0]}},line2d:{category:i.PRIMITIVE_CAT.FEATURE,enableZOffset:!0,validate:function(t,e,r){return t.vertices&&t.vertices.length>=2&&\"/route_follower/kickout/object/velocity\"!==e},normalize:function(t){t.vertices=(0,n.filterVertices)(t.vertices)}},polygon2d:{category:i.PRIMITIVE_CAT.FEATURE,enableZOffset:!0,validate:function(t,e,r){return t.vertices&&t.vertices.length>=3},normalize:function(t){Array.isArray(t.vertices)&&t.vertices.push(t.vertices[0])}},circle:{category:i.PRIMITIVE_CAT.FEATURE,enableZOffset:!0,validate:function(t,e,r){return t.vertices&&t.vertices.length>0}},circle2d:{category:i.PRIMITIVE_CAT.FEATURE,enableZOffset:!0,validate:function(t,e,r){return t.center},normalize:function(t){t.vertices=t.center}}};e.default=o},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=void 0;var n,i=r(28),o=r(12),a=(n=r(22))&&n.__esModule?n:{default:n};function u(t){t&&t.base&&t.base.object_id&&(t.id=t.base.object_id)}var s={text:{category:o.PRIMITIVE_CAT.FEATURE,validate:function(t){return!0},normalize:function(t){u(t)}},circle:{category:o.PRIMITIVE_CAT.FEATURE,validate:function(t){return t.center},normalize:function(t){u(t)}},stadium:{category:o.PRIMITIVE_CAT.FEATURE,validate:function(t){return t.start&&t.end},normalize:function(t){u(t)}},polyline:{category:o.PRIMITIVE_CAT.FEATURE,validate:function(t,e,r){return t.vertices&&t.vertices.length>=2},normalize:function(t){t.vertices=(0,i.filterVertices)(t.vertices),u(t)}},polygon:{category:o.PRIMITIVE_CAT.FEATURE,validate:function(t,e,r){return t.vertices&&t.vertices.length>=3},normalize:function(t){u(t)}},point:{category:o.PRIMITIVE_CAT.POINTCLOUD,validate:function(t,e,r){return t.points&&t.points.length>0},normalize:function(t){t.vertices=t.points,u(t)}},image:{category:o.PRIMITIVE_CAT.IMAGE,validate:function(t,e,r){return t.data},normalize:function(t){var e=t.data;delete t.data,\"string\"==typeof e&&(e=a.default.toByteArray(e));var r=t.format?\"image/\".concat(t.format):null;t.imageData=e,t.imageType=r,t.position&&(t.vertices=t.position),u(t)}}};e.default=s},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=function(t,e){var r=t.update_type,n=t.updates;if(\"snapshot\"!==r)return s.default.error('Only XVIZ update_type of \"snapshot\" is currently supported. Type \"'.concat(r,'\" is not supported.'))(),{type:i.LOG_STREAM_MESSAGE.INCOMPLETE,message:\"Unsupported update type\"};if(!n)return{type:i.LOG_STREAM_MESSAGE.INCOMPLETE,message:'Missing required \"updates\" property'};if(n&&0===n.length)return{type:i.LOG_STREAM_MESSAGE.INCOMPLETE,message:'Property \"updates\" has length of 0, no data?'};n.length>1&&s.default.warn('Only XVIZ first update of \"snapshot\" is currently supported. Current updates has \"'.concat(n.length,'\" entries.'))();var c=n,f=null;!f&&c&&(f=c.reduce(function(t,e){return Math.max(t,e.timestamp)},0));if(!f)return{type:i.LOG_STREAM_MESSAGE.INCOMPLETE,message:'Missing timestamp in \"updates\"'};var h={},l={type:i.LOG_STREAM_MESSAGE.TIMESLICE,streams:h,timestamp:f};if(c){var v=function(t,e,r){var n=(0,o.getXVIZConfig)().STREAM_BLACKLIST,i={},s={},c={},f={},h=[],l={},v={},y=!0,g=!1,d=void 0;try{for(var p,m=t[Symbol.iterator]();!(y=(p=m.next()).done);y=!0){var b=p.value;Object.assign(s,b.poses),Object.assign(c,b.primitives),Object.assign(f,b.variables),Object.assign(l,b.future_instances),Object.assign(v,b.ui_primitives),b.time_series&&h&&h.push.apply(h,function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(E=b.time_series)||function(t){if(Symbol.iterator in Object(t)||\"[object Arguments]\"===Object.prototype.toString.call(t))return Array.from(t)}(E)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}())}}catch(t){g=!0,d=t}finally{try{y||null==m.return||m.return()}finally{if(g)throw d}}var E;if(Object.keys(s).filter(function(t){return!n.has(t)}).forEach(function(t){i[t]=(0,a.parseXVIZPose)(s[t])}),Object.keys(c).filter(function(t){return!n.has(t)}).forEach(function(t){i[t]=(0,u.parseStreamPrimitive)(c[t],t,e,r)}),Object.keys(f).filter(function(t){return!n.has(t)}).forEach(function(t){i[t]=(0,u.parseStreamVariable)(f[t],t,e)}),h.length){var k=(0,u.parseStreamTimeSeries)(h,n);Object.assign(i,k)}return Object.keys(l).filter(function(t){return!n.has(t)}).forEach(function(t){i[t]=(0,u.parseStreamFutures)(l[t],t,e,r)}),Object.keys(v).filter(function(t){return!n.has(t)}).forEach(function(t){i[t]=(0,u.parseStreamUIPrimitives)(v[t],t,e)}),i}(c,f,e);Object.assign(h,v)}return l};var n,i=r(7),o=r(4),a=r(102),u=r(26),s=(n=r(27))&&n.__esModule?n:{default:n}},function(t,e,r){\"use strict\";function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==u.return||u.return()}finally{if(i)throw o}}return r}(t,e)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}Object.defineProperty(e,\"__esModule\",{value:!0}),e.parseXVIZPose=function(t){var e=t.mapOrigin,r=t.position,o=t.orientation,a={timestamp:t.timestamp};if(e){var u=e.longitude,s=e.latitude,c=e.altitude;Object.assign(a,{longitude:u,latitude:s,altitude:c})}if(r){var f=i(r,3),h=f[0],l=f[1],v=f[2];Object.assign(a,{x:h,y:l,z:v})}if(o){var y=i(o,3),g=y[0],d=y[1],p=y[2];Object.assign(a,{roll:g,pitch:d,yaw:p})}return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},i=Object.keys(r);\"function\"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),i.forEach(function(e){n(t,e,r[e])})}return t}({},t,a)}},function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.preSerialize=function(t){return t},e.postDeserialize=function(t){if(t.type!==i.LOG_STREAM_MESSAGE.TIMESLICE)return t;var e=(0,o.getXVIZConfig)().OBJECT_STREAM,r=t.streams,n=t.timestamp;if(e)return u(r[e],n),t;for(var a in r){var s=r[a];s.features&&s.features.length&&s.features[0].id&&u(s,n)}return t};var n,i=r(7),o=r(4),a=(n=r(11))&&n.__esModule?n:{default:n};function u(t,e){t&&t.features.forEach(function(t){a.default.observe(t.id,e)})}},function(t,e,r){\"use strict\";function n(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}function a(t){return(a=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function u(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=r||new Set;if(t){if(t instanceof ArrayBuffer)n.add(t);else if(t.buffer&&t.buffer instanceof ArrayBuffer)n.add(t.buffer);else if(e&&\"object\"===a(t))for(var i in t)u(t[i],!1,n)}else;return void 0===r?Array.from(n):null}Object.defineProperty(e,\"__esModule\",{value:!0}),e.getTransferList=u,e.WorkerFarm=void 0;var s=function(){function t(e){var r=e.url,i=e.metadata;n(this,t),this.worker=new Worker(r),this.isBusy=!1,this.metadata=i}return o(t,[{key:\"process\",value:function(t){var e=this,r=this.worker;return new Promise(function(n,i){r.onmessage=function(t){e.isBusy=!1,n(t.data)},r.onerror=function(t){e.isBusy=!1,i(t)},e.isBusy=!0,r.postMessage(t,u(t))})}},{key:\"terminate\",value:function(){this.worker.terminate(),this.worker=null}}]),t}(),c=function(){function t(e){var r=e.workerURL,i=e.maxConcurrency,o=void 0===i?1:i,a=e.debug,u=void 0===a?function(){}:a,c=e.initialMessage,f=void 0===c?null:c;n(this,t),this.workerURL=r,this.workers=[],this.queue=[],this.debug=u;for(var h=0;h<o;h++)this.workers[h]=new s({url:this.workerURL,metadata:{name:\"\".concat(h,\"/\").concat(o)}});f&&this.broadcast(f)}return o(t,[{key:\"destroy\",value:function(){this.workers.forEach(function(t){return t.terminate()})}},{key:\"getAvailableWorker\",value:function(){return this.workers.find(function(t){return!t.isBusy})}},{key:\"broadcast\",value:function(t){for(var e=this.workers.length-1;e>=0;e--)this.workers[e].worker.postMessage(t,u(t))}},{key:\"next\",value:function(){for(var t=this,e=this.queue;e.length;){var r=this.getAvailableWorker();if(!r)break;var n=e.shift();this.debug({message:\"processing\",worker:r.metadata.name,backlog:e.length}),r.process(n.data).then(n.onResult).catch(n.onError).then(function(){return t.next()})}}},{key:\"process\",value:function(t,e,r){this.queue.push({data:t,onResult:e,onError:r}),this.next()}}]),t}();e.WorkerFarm=c},function(t,e,r){\"use strict\";r.r(e);var n={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},i={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},o={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},a={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},u={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4};var s=r(69),c={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},f={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},h={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function l(t,e,r){r&&(t=function(t,e){for(var r=t.byteLength-e,n=new ArrayBuffer(r),i=new Uint8Array(t),o=new Uint8Array(n),a=0;a<r;a++)o[a]=i[e+a];return n}(t,r));for(var n=e.bufferViews||[],i=0;i<n.length;++i){var o=n[i];Object(s.a)(o.byteLength>=0)}return{accessors:v(t,n,e),images:y(t,n,e)}}function v(t,e,r){for(var n=r.accessors||[],i=[],o=0;o<n.length;++o){var a=n[o];Object(s.a)(a);var u=e[a.bufferView];Object(s.a)(u);var c=g(a,u),f=c.ArrayType,h=c.length,l=new f(t,u.byteOffset,h);l.accessor=a,i.push(l)}return i}function y(t,e,r){for(var n=r.images||[],i=[],o=0;o<n.length;++o){var a=n[o];Object(s.a)(a);var u=e[a.bufferView];Object(s.a)(u);var c=new Uint8Array(t,u.byteOffset,u.byteLength);c.imate=a,i.push(c)}return i}function g(t,e){var r=h[t.componentType],n=c[t.type],i=f[t.componentType],o=t.count*n,a=t.count*n*i;return Object(s.a)(a>=0&&a<=e.byteLength),{ArrayType:r,length:o,byteLength:a}}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==u.return||u.return()}finally{if(i)throw o}}return r}(t,e)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}function p(t){return(p=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function m(t,e){return function t(e,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var o=e;var a=function(t,e){var r=function(t){if(\"string\"==typeof t){if(0===t.indexOf(\"##/\"))return t.slice(1);var e=t.match(/\\#\\/([a-z]+)\\/([0-9]+)/);if(e){var r=parseInt(e[2],10);return[e[1],r]}if(e=t.match(/\\$\\$\\$([0-9]+)/)){var n=parseInt(e[1],10);return[\"accessors\",n]}}return null}(t);if(r){var n=d(r,2),i=n[0],o=n[1],a=e[i]&&e[i][o];if(a)return a;console.error(\"Invalid JSON pointer \".concat(t,\": #/\").concat(i,\"/\").concat(o))}return null}(o,n);if(a)return a;if(Array.isArray(o))return o.map(function(e){return t(e,r,n,i)});if(null!==o&&\"object\"===p(o)){var u={};for(var s in o)u[s]=t(o[s],r,n,i);return u}return o}(t,t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}var b=r(70),E=r(71);function k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function w(t,e,r){return e&&k(t.prototype,e),r&&k(t,r),t}var _=function(){function t(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.binaryByteOffset=null,this.packedJson=null,this.json=null}return w(t,null,[{key:\"isGLB\",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).magic,r=void 0===e?1735152710:e,n=new DataView(t).getUint32(0,!1);return n===r||1735152710===n}}]),w(t,[{key:\"parse\",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.glbArrayBuffer=t,null===this.json&&null===this.binaryByteOffset&&(this.result=this._parse(e)),this}},{key:\"getApplicationData\",value:function(t){return this.json[t]}},{key:\"getJSON\",value:function(){return this.json}},{key:\"getArrayBuffer\",value:function(){return this.glbArrayBuffer}},{key:\"getBinaryByteOffset\",value:function(){return this.binaryByteOffset}},{key:\"getBufferView\",value:function(t){var e=(t.byteOffset||0)+this.binaryByteOffset;return new Uint8Array(this.glbArrayBuffer,e,t.byteLength)}},{key:\"getBuffer\",value:function(t){var e=o[t.componentType],r=n[t.type],a=i[t.componentType],u=t.count*r,c=t.count*r*a,f=this.json.bufferViews[t.bufferView];Object(s.a)(c>=0&&c<=f.byteLength);var h=f.byteOffset+this.binaryByteOffset;return new e(this.arrayBuffer,h,u)}},{key:\"getImageData\",value:function(t){return{typedArray:this.getBufferView(t.bufferView),mimeType:t.mimeType||\"image/jpeg\"}}},{key:\"getImage\",value:function(t){var e=this.getBufferView(t.bufferView),r=t.mimeType||\"image/jpeg\",n=new Blob([e],{type:r}),i=(self.URL||self.webkitURL).createObjectURL(n),o=new Image;return o.src=i,o}},{key:\"getImageAsync\",value:function(t){var e=this;return new Promise(function(r){var n=e.getBufferView(t.bufferView),i=t.mimeType||\"image/jpeg\",o=new Blob([n],{type:i}),a=(self.URL||self.webkitURL).createObjectURL(o),u=new Image;u.onload=function(){return r(u)},u.src=a})}},{key:\"_parse\",value:function(t){var e=this._parseBinary(t);this.packedJson=e.json,this.unpackedBuffers=l(this.glbArrayBuffer,this.json,this.binaryByteOffset),this.json=m(this.json,this.unpackedBuffers)}},{key:\"_parseBinary\",value:function(t){var e=t.magic,r=void 0===e?1735152710:e,n=new DataView(this.glbArrayBuffer),i=n.getUint32(0,!1),o=n.getUint32(4,!0),a=n.getUint32(8,!0),u=1735152710===i||i===r;u||console.warn(\"Invalid GLB magic string \".concat(function(t){return\"\".concat(String.fromCharCode(t.getUint8(0))).concat(String.fromCharCode(t.getUint8(1))).concat(String.fromCharCode(t.getUint8(2))).concat(String.fromCharCode(t.getUint8(3)))}(n))),Object(s.a)(2===o,\"Invalid GLB version \".concat(o,\". Only .glb v2 supported\")),Object(s.a)(a>20);var c=n.getUint32(12,!0),f=n.getUint32(16,!0);u=1313821514===f||0===f,Object(s.a)(u,\"JSON chunk format \".concat(f));var h=new Uint8Array(this.glbArrayBuffer,20,c),l=new b.TextDecoder(\"utf8\").decode(h);this.json=JSON.parse(l);var v=20+Object(E.b)(c);this.binaryByteOffset=v+8;var y=n.getUint32(v+4,!0);return u=5130562===y||1===y,Object(s.a)(u,\"BIN chunk format \".concat(y)),{arrayBuffer:this.glbArrayBuffer,binaryByteOffset:this.binaryByteOffset,json:this.json}}}]),t}();function A(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var T={magFilter:10240,minFilter:10241,wrapS:10242,wrapT:10243},M={createImages:!1},O=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.log=console,this.out={},this.options=Object.assign({},M,e),this.DracoDecoder=this.options.DracoDecoder||null}var e,r,n;return e=t,(r=[{key:\"parse\",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object.assign({},this.options,e);return t instanceof ArrayBuffer?(this.glbParser=new _,this.gltf=this.glbParser.parse(t).json,this.json=this.gltf):(this.glbParser=null,this.gltf=t,this.json=t),this._loadLinkedAssets(r),this._resolveToTree(r),this.gltf}},{key:\"getApplicationData\",value:function(t){return this.json[t]}},{key:\"getExtraData\",value:function(t){return(this.json.extras||{})[t]}},{key:\"getExtension\",value:function(t){return this.json.extensions[t]}},{key:\"getRequiredExtensions\",value:function(){return this.json.extensionsRequired}},{key:\"getUsedExtensions\",value:function(){return this.json.extensionsUsed}},{key:\"unpackMesh\",value:function(t){return t.primitives.map(this.unpackPrimitive.bind(this))}},{key:\"unpackPrimitive\",value:function(t){var e=t.extensions&&t.extensions.UBER_draco_mesh_compression,r=t.extensions&&t.extensions.UBER_draco_point_cloud_compression,n={mode:t.mode,material:t.material};if(e){var i=new this.DracoDecoder,o=i.decodeMesh(e);i.destroy(),Object.assign(n,{indices:o.indices,attributes:o.attributes})}else if(r){var a=new this.DracoDecoder,u=a.decodePointCloud(r);a.destroy(),Object.assign(n,{mode:0,attributes:u.attributes})}}},{key:\"getScene\",value:function(t){return this._get(\"scenes\",t)}},{key:\"getNode\",value:function(t){return this._get(\"nodes\",t)}},{key:\"getSkin\",value:function(t){return this._get(\"skins\",t)}},{key:\"getMesh\",value:function(t){return this._get(\"meshes\",t)}},{key:\"getDecompressedMesh\",value:function(t){if(!this.DracoDecoder)throw new Error(\"DracoDecoder not available\");var e=this._get(\"meshes\",t),r=!0,n=!1,i=void 0;try{for(var o,a=e.primitives[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var u=o.value,s=u.extensions;\"UBER_draco_point_cloud_compression\"in s&&this._decompressUberDracoPointCloud(u,s)}}catch(t){n=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}return e}},{key:\"getMaterial\",value:function(t){return this._get(\"materials\",t)}},{key:\"getAccessor\",value:function(t){return this._get(\"accessors\",t)}},{key:\"getCamera\",value:function(t){return null}},{key:\"getTexture\",value:function(t){return this._get(\"textures\",t)}},{key:\"getSampler\",value:function(t){return this._get(\"samplers\",t)}},{key:\"getImage\",value:function(t){return this._get(\"images\",t)}},{key:\"getBufferView\",value:function(t){return this._get(\"bufferViews\",t)}},{key:\"getBuffer\",value:function(t){return this._get(\"buffers\",t)}},{key:\"_get\",value:function(t,e){var r=this.gltf[t]&&this.gltf[t][e];return r||console.warn(\"glTF file error: Could not find \".concat(t,\"[\").concat(e,\"]\")),r}},{key:\"_loadLinkedAssets\",value:function(t){}},{key:\"_postProcessGLTF\",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.out.images=(this.gltf.images||[]).map(function(r){return t.parseImage(r,e)}).filter(Boolean),this.out.scenes=(this.gltf.scenes||[]).map(function(r){return t.parseScene(r,e)}).filter(Boolean),void 0!==this.gltf.scene&&(this.out.scene=this.gltf.scenes[this.gltf.scene]),this}},{key:\"_resolveToTree\",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.gltf;return(r.bufferViews||[]).forEach(function(e,r){return t._resolveBufferView(e,r)}),(r.images||[]).forEach(function(r,n){return t._resolveImage(r,n,e)}),(r.samplers||[]).forEach(function(e,r){return t._resolveSampler(e,r)}),(r.textures||[]).forEach(function(e,r){return t._resolveTexture(e,r)}),(r.accessors||[]).forEach(function(e,r){return t._resolveAccessor(e,r)}),(r.materials||[]).forEach(function(e,r){return t._resolveMaterial(e,r)}),(r.meshes||[]).forEach(function(e,r){return t._resolveMesh(e,r)}),(r.nodes||[]).forEach(function(e,r){return t._resolveNode(e,r)}),(r.skins||[]).forEach(function(e,r){return t._resolveSkin(e,r)}),(r.scenes||[]).forEach(function(e,r){return t._resolveScene(e,r)}),void 0!==r.scene&&(r.scene=r.scenes[this.gltf.scene]),r}},{key:\"_resolveScene\",value:function(t,e){var r=this;t.id=\"scene-\".concat(e),t.nodes=(t.nodes||[]).map(function(t){return r.getNode(t)})}},{key:\"_resolveNode\",value:function(t,e){var r=this;t.id=\"node-\".concat(e),t.children=(t.children||[]).map(function(t){return r.getNode(t)}),void 0!==t.mesh&&(t.mesh=this.getMesh(t.mesh)),void 0!==t.camera&&(t.camera=this.getCamera(t.camera)),void 0!==t.skin&&(t.skin=this.getSkin(t.skin))}},{key:\"_resolveSkin\",value:function(t,e){t.id=\"skin-\".concat(e),t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices)}},{key:\"_resolveMesh\",value:function(t,e){t.id=\"mesh-\".concat(e);var r=!0,n=!1,i=void 0;try{for(var o,a=t.primitives[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var u=o.value;for(var s in u.attributes)u.attributes[s]=this.getAccessor(u.attributes[s]);void 0!==u.indices&&(u.indices=this.getAccessor(u.indices)),void 0!==u.material&&(u.material=this.getMaterial(u.material))}}catch(t){n=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}}},{key:\"_resolveMaterial\",value:function(t,e){if(t.id=\"material-\".concat(e),t.normalTexture&&(t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.pbrMetallicRoughness){var r=t.pbrMetallicRoughness;r.baseColorTexture&&(r.baseColorTexture.texture=this.getTexture(r.baseColorTexture.index)),r.metallicRoughnessTexture&&(r.metallicRoughnessTexture.texture=this.getTexture(r.metallicRoughnessTexture.index))}}},{key:\"_resolveAccessor\",value:function(t,e){t.id=\"accessor-\".concat(e),t.bufferView=this.getBufferView(t.bufferView),t.bytesPerComponent=u[t],t.components=a[t],t.bytesPerElement=t.bytesPerComponent*t.components}},{key:\"_resolveTexture\",value:function(t,e){t.id=\"texture-\".concat(e),t.sampler=this.getSampler(t.sampler),t.source=this.getImage(t.source)}},{key:\"_resolveSampler\",value:function(t,e){for(var r in t.id=\"sampler-\".concat(e),t.parameters={},t){var n=this._enumSamplerParameter(r);void 0!==n&&(t.parameters[n]=t[r])}}},{key:\"_enumSamplerParameter\",value:function(t){return T[t]}},{key:\"_resolveImage\",value:function(t,e,r){var n=this;t.id=\"image-\".concat(e),void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView));var i=r.createImages;void 0===i||i?t.image=this.glbParser.getImage(t):t.getImageAsync=function(){return n.glbParser.getImageAsync(t)}}},{key:\"_resolveBufferView\",value:function(t,e){t.id=\"bufferView-\".concat(e),t.buffer=this.getBuffer(t.buffer),this.glbParser&&(t.data=this.glbParser.getBufferView(t))}},{key:\"_decompressUberDracoPointCloud\",value:function(t,e){var r=e.UBER_draco_point_cloud_compression.bufferView,n=this.getBufferView(r),i=this.glbParser.getBufferView(n),o=(new this.DracoDecoder).decode(i);t.attributes=o.attributes,t.header=o.header,t.drawMode=o.drawMode||0}},{key:\"_resolveCamera\",value:function(t){t.perspective,t.orthographic}}])&&A(e.prototype,r),n&&A(e,n),t}();var S={name:\"glTF\",extension:[\"gltf\",\"glb\"],parseTextSync:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new O).parse(t,e)},parseSync:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new O).parse(t,e)}},j=r(108);function I(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==u.return||u.return()}finally{if(i)throw o}}return r}(t,e)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}var x=!1,P=!0,R=new Map([[\"image/png\",function(t){var e=Object(j.b)(t);if(e.byteLength<24||2303741511!==e.getUint32(0,x))return null;return{width:e.getUint32(16,x),height:e.getUint32(20,x)}}],[\"image/jpeg\",function(t){var e=Object(j.b)(t);if(e.byteLength<2||65496!==e.getUint16(0,x))return null;var r=function(){for(var t=new Set([65499,65476,65484,65501,65534]),e=65504;e<65520;++e)t.add(e);var r=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:t,sofMarkers:r}}(),n=r.tableMarkers,i=r.sofMarkers,o=2;for(;o<e.byteLength;){var a=e.getUint16(o,x);if(i.has(a))return{height:e.getUint16(o+5,x),width:e.getUint16(o+7,x)};if(!n.has(a))return null;o+=2,o+=e.getUint16(o,x)}return null}],[\"image/gif\",function(t){var e=Object(j.b)(t);if(e.byteLength<10||1195984440!==e.getUint32(0,x))return null;return{width:e.getUint16(6,P),height:e.getUint16(8,P)}}],[\"image/bmp\",function(t){var e=Object(j.b)(t);if(16973!==e.getUint16(0,x))return null;return{width:e.getUint32(18,P),height:e.getUint32(22,P)}}]]),L=\"Invalid MIME type. Supported MIME types are: \".concat(Array.from(R.keys()).join(\", \"));function B(t,e){var r=!0,n=!1,i=void 0;try{for(var o,a=R.entries()[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var u=I(o.value,2),s=u[0],c=(0,u[1])(t);if(c)return c.mimeType=s,c}}catch(t){n=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}return null}var C=[\"SCALAR\",\"VEC2\",\"VEC3\",\"VEC4\"],V=new Map([[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126]]);function U(t){var e=V.get(t.constructor);if(!e)throw new Error(\"Illegal typed array\");return e}function N(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Float32Array;if(0===t.length)return new Float32Array(0);if(!function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.isFinite;var n=-1;for(;++n<e.length;){var i=e[n];if(Array.isArray(i)||ArrayBuffer.isView(i)){if(!t(i,r))return!1}else if(!r(i))return!1}return!0}(t))return null;var r=new e(function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;var n=0;var i=0;var o=-1;for(;++o<e.length;){var a=e[o];Array.isArray(a)||ArrayBuffer.isView(a)?n+=t(a):i++}return n+(0===n&&i<r?r:i)}(t));return function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;(function t(e,r,n,i){for(var o=-1,a=0;++o<e.length;){var u=e[o];Array.isArray(u)||ArrayBuffer.isView(u)?i=t(u,r,n,i):a<n&&(r[i++]=u,a++)}return a>0&&a<n&&(r[i++]=0),i})(t,e,r,0)}(t,r),r}function D(t){return(D=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function F(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.flattenArrays,i=void 0!==n&&n,o=t;if(\"string\"==typeof o&&0===o.indexOf(\"#/\"))return\"#\".concat(o);if(Array.isArray(o)){var a=i&&N(o);if(!a)return o.map(function(t){return F(t,e,r)});o=a}if(ArrayBuffer.isView(o)&&e){if(e.isImage(o)){var u=e.addImage(o);return\"#/images/\".concat(u)}var s=e.addBuffer(o);return\"#/accessors/\".concat(s)}if(null!==o&&\"object\"===D(o)){var c={};for(var f in o)c[f]=F(o[f],e,r);return c}return o}function Y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Z=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.byteLength=0,this.json={buffers:[{byteLength:0}],bufferViews:[],accessors:[],images:[],meshes:[]},this.sourceBuffers=[],this.log=e.log||console}var e,r,n;return e=t,(r=[{key:\"getByteLength\",value:function(){return this.byteLength}},{key:\"isImage\",value:function(t){return!!(e=B(t))&&e.mimeType;var e}},{key:\"encodeAsGLB\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._createGLBBuffer(t)}},{key:\"addApplicationData\",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.nopack?e:F(e,this,r);return this.json[t]=n,this}},{key:\"addBuffer\",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{size:3},r=this.addBufferView(t),n={size:e.size,componentType:U(t),count:Math.round(t.length/e.size)};return this.addAccessor(r,Object.assign(n,e))}},{key:\"addBufferView\",value:function(t){var e=t.byteLength||t.length;return this.json.bufferViews.push({buffer:0,byteOffset:this.byteLength,byteLength:e}),this.byteLength+=Object(E.b)(e),this.sourceBuffers.push(t),this.json.bufferViews.length-1}},{key:\"addAccessor\",value:function(t,e){var r;return this.json.accessors.push({bufferView:t,type:(r=e.size,C[r-1]||C[0]),componentType:e.componentType,count:e.count}),this.json.accessors.length-1}},{key:\"_pack\",value:function(){return this._packBinaryChunk(),{arrayBuffer:this.arrayBuffer,json:this.json}}},{key:\"_packBinaryChunk\",value:function(){if(!this.arrayBuffer){for(var t=this.byteLength,e=new ArrayBuffer(t),r=new Uint8Array(e),n=0,i=0;i<this.sourceBuffers.length;i++){var o=this.sourceBuffers[i];n=Object(j.a)(o,r,n)}this.json.buffers[0].byteLength=t,this.arrayBuffer=e,this.sourceBuffers=[]}}},{key:\"_createGLBBuffer\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._packBinaryChunk();var e=this.arrayBuffer;t.magic&&console.warn(\"Custom glTF magic number no longer supported\");var r=this._convertObjectToJsonChunk(this.json),n=Object(E.b)(r.byteLength)+20,i=n+8+Object(E.b)(e.byteLength),o=new ArrayBuffer(i),a=new DataView(o);a.setUint32(0,1735152710,!1),a.setUint32(4,2,!0),a.setUint32(8,i,!0),a.setUint32(12,r.byteLength,!0),a.setUint32(16,0,!0),Object(E.a)(o,r,20);var u=Object(E.b)(e.byteLength);return a.setUint32(n+0,u,!0),a.setUint32(n+4,1,!0),Object(E.a)(o,e,n+8),o}},{key:\"_getInternalCounts\",value:function(){return{buffers:this.json.buffers.length,bufferViews:this.json.bufferViews.length,accessors:this.json.accessors.length,images:this.json.images.length}}},{key:\"_convertObjectToJsonChunk\",value:function(t){var e=JSON.stringify(t);return new b.TextEncoder(\"utf8\").encode(e)}}])&&Y(e.prototype,r),n&&Y(e,n),t}();function X(t){return(X=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function G(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function q(t,e){return!e||\"object\"!==X(e)&&\"function\"!=typeof e?function(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}(t):e}function J(t){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function H(t,e){return(H=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var W=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,e),(t=q(this,J(e).call(this,r))).DracoEncoder=r.DracoEncoder,t.DracoDecoder=r.DracoDecoder,Object.assign(t.json,{meshes:[]}),t}var r,n,i;return function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&H(t,e)}(e,Z),r=e,(n=[{key:\"addApplicationData\",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.nopack?e:F(e,this,r);return this.json[t]=n,this}},{key:\"addExtraData\",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=!r.nopack&&F(e,this,r);return this.json.extras=this.json.extras||{},this.json.extras[t]=n,this}},{key:\"addExtension\",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(s.a)(e);var n=!r.nopack&&F(e,this,r);return this.json.extensions=this.json.extensions||{},this.json.extensions[t]=n,this.registerUsedExtension(t),this}},{key:\"addRequiredExtension\",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(s.a)(e);var n=!r.nopack&&F(e,this,r);return this.addExtension(t,n),this.registerRequiredExtension(t),this}},{key:\"registerUsedExtension\",value:function(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(function(e){return e===t})||this.json.extensionsUsed.push(t)}},{key:\"registerRequiredExtension\",value:function(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(function(e){return e===t})||this.json.extensionsRequired.push(t)}},{key:\"addMesh\",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n={primitives:[{attributes:this._addAttributes(t),indices:e,mode:r}]};return this.json.meshes.push(n),this.json.meshes.length-1}},{key:\"addPointCloud\",value:function(t){var e={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes.push(e),this.json.meshes.length-1}},{key:\"addCompressedMesh\",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;if(!this.DracoEncoder||!this.DracoDecoder)throw new Error(\"DracoEncoder/Decoder not available\");var n=(new this.DracoEncoder).encodeMesh(t),i=(new this.DracoDecoder).decodeMesh(t),o={primitives:[{attributes:this._addFauxAttributes(i.attributes),mode:r,extensions:G({},\"UBER_draco_mesh_compression\",{bufferView:this.addBufferView(n)})}]};return this.registerRequiredExtension(\"UBER_draco_mesh_compression\"),this.json.meshes.push(o),this.json.meshes.length-1}},{key:\"addCompressedPointCloud\",value:function(t){if(!this.DracoEncoder||!this.DracoDecoder)throw new Error(\"DracoEncoder/Decoder not available\");var e=(new this.DracoEncoder).encodePointCloud(t),r={primitives:[{attributes:{},mode:0,extensions:G({},\"UBER_draco_point_cloud_compression\",{bufferView:this.addBufferView(e)})}]};return this.registerRequiredExtension(\"UBER_draco_point_cloud_compression\"),this.json.meshes.push(r),this.json.meshes.length-1}},{key:\"addImage\",value:function(t){var e=this.addBufferView(t),r=function(t,e){if(e){var r=R.get(e);if(!r)throw new Error(L);var n=r(t);if(!n)throw new Error(\"invalid image data for type: \".concat(e));return n}var i=B(t);if(!i)throw new Error(L);return i}(t)||{};if(r){var n=r.mimeType,i=r.width,o=r.height;this.json.images.push({bufferView:e,mimeType:n,width:i,height:o})}else this.json.images.push({bufferView:e});return this.json.images.length-1}}])&&z(r.prototype,n),i&&z(r,i),e}();var K={name:\"GLB\",extension:\"glb\",encodeToBinary:function(t,e){return(new W).encodeAsGLB(t,e)}};r.d(e,\"GLTFLoader\",function(){return S}),r.d(e,\"GLTFWriter\",function(){return K}),r.d(e,\"GLTFParser\",function(){return O}),r.d(e,\"GLTFBuilder\",function(){return W}),r.d(e,\"GLBParser\",function(){return _}),r.d(e,\"GLBBuilder\",function(){return Z}),r.d(e,\"ATTRIBUTE_TYPE_TO_COMPONENTS\",function(){return n}),r.d(e,\"ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE\",function(){return i}),r.d(e,\"ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY\",function(){return o})},function(t,e,r){\"use strict\";r.r(e);var n=r(5),i=\"2.0.1\",o=Object(n.a)(),a=r(2),u=r(8);function s(){return void 0!==a.f.orientation}function c(t){if(!t&&!Object(n.a)())return\"Node\";if(Object(u.a)(t))return\"Electron\";var e=\"undefined\"!=typeof navigator?navigator:{},r=t||e.userAgent||\"\";if(r.indexOf(\"Edge\")>-1)return\"Edge\";var i=-1!==r.indexOf(\"MSIE \"),o=-1!==r.indexOf(\"Trident/\");return i||o?\"IE\":a.f.chrome?\"Chrome\":a.f.safari?\"Safari\":a.f.mozInnerScreenX?\"Firefox\":\"Unknown\"}function f(t,e){if(!t)throw new Error(\"Assertion failed. \".concat(e))}var h=r(1),l=r(0);function v(){if(!o){var t=a.d.hrtime();return t[0]+t[1]/1e6}return a.f.performance?a.f.performance.now():Date.now()}v();function y(t){return t<10?\"\".concat(t.toFixed(2),\"ms\"):t<100?\"\".concat(t.toFixed(1),\"ms\"):t<1e3?\"\".concat(t.toFixed(0),\"ms\"):\"\".concat((t/1e3).toFixed(2),\"s\")}function g(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,i=t.src.replace(/\\(/g,\"%28\").replace(/\\)/g,\"%29\");t.width>n&&(r=Math.min(r,n/t.width));var o=t.width*r,a=t.height*r,u=[\"font-size:1px;\",\"padding:\".concat(Math.floor(a/2),\"px \").concat(Math.floor(o/2),\"px;\"),\"line-height:\".concat(a,\"px;\"),\"background:url(\".concat(i,\");\"),\"background-size:\".concat(o,\"px \").concat(a,\"px;\"),\"color:transparent;\"].join(\"\");return[\"\".concat(e,\" %c+\"),u]}var d=function(){function t(e){var r=e.id;Object(h.a)(this,t),this.id=r,this.time=v(),this.counters={},Object.seal(this)}return Object(l.a)(t,[{key:\"addCounter\",value:function(t){return this._getCounter(t),this}},{key:\"bump\",value:function(t){var e=this._getCounter(t);return e.call++,e.count++,this}},{key:\"increment\",value:function(t,e){var r=this._getCounter(t);return r.call++,r.count+=e,this}},{key:\"addTimer\",value:function(t){return this._getCounter(t).time=0,this}},{key:\"addTime\",value:function(t,e){var r=this._getCounter(t);return r.time+=e,r.count++,this}},{key:\"timeStart\",value:function(t,e){this._getCounter(t)._startTime=v()}},{key:\"timeEnd\",value:function(t,e){var r=this._getCounter(t);this.addTime(t,v()-r._startTime)}},{key:\"reset\",value:function(){for(var t in this.time=v(),this.counters){var e=this.counters[t];e.count=0,e.time=0}return this}},{key:\"hasTimeElapsed\",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return v()-this.time>1e3}},{key:\"getStats\",value:function(){var t=(v()-this.time)/1e3,e={};for(var r in this.counters){var n=this.counters[r];e[n.title]={total:n.count,fps:Math.round(n.count/t)},n.time&&(e[n.title].totalTime=y(n.time),e[n.title].avgTime=y(n.time/n.count))}return e}},{key:\"getStatsTable\",value:function(){var t=this.getStats();for(var e in t)0===t[e].total&&delete t[e];return t}},{key:\"getStatNames\",value:function(){return Object.keys(this.counters)}},{key:\"get\",value:function(t){return this._getCounter(t).count}},{key:\"getCount\",value:function(t){return this._getCounter(t).count}},{key:\"getFPS\",value:function(t){var e=this._getCounter(t),r=(v()-this.time)/1e3;return Math.round(e.count/r)}},{key:\"getTimeString\",value:function(){return\"\".concat(this.id,\":\").concat(y(this.time),\"(\").concat(this.count,\")\")}},{key:\"oneSecondPassed\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return this.hasTimeElapsed(t)}},{key:\"_getCounter\",value:function(t){var e=this.counters[t];return e||(e={title:t,unit:\"\",timer:!1,count:0,time:0,totalTime:0,averageTime:0},this.counters[t]=e),e}},{key:\"_incrementTimer\",value:function(t,e,r){t.count+=r,t.totalTime+=e,t.averageTime=t.totalTime/r}}]),t}(),p=r(3),m=r(6);var b=function(){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"sessionStorage\";Object(h.a)(this,t),this.storage=function(t){try{var e=window[t],r=\"__storage_test__\";return e.setItem(r,r),e.removeItem(r),e}catch(t){return null}}(n),this.id=e,this.config={},Object.assign(this.config,r),this._loadConfiguration()}return Object(l.a)(t,[{key:\"getConfiguration\",value:function(){return this.config}},{key:\"setConfiguration\",value:function(t){return this.config={},this.updateConfiguration(t)}},{key:\"updateConfiguration\",value:function(t){if(Object.assign(this.config,t),this.storage){var e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}return this}},{key:\"_loadConfiguration\",value:function(){var t={};if(this.storage){var e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}]),t}(),E={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function k(t){return\"string\"==typeof t?E[t.toUpperCase()]||E.WHITE:t}function w(t,e){if(!t)throw new Error(\"Assertion failed. \".concat(e))}var _={debug:o&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},A={enabled:!1,priority:0};function T(){}var M={};var O=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id;Object(h.a)(this,t),this.id=e,this.VERSION=i,this._startTs=v(),this._deltaTs=v(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new b(\"__probe-\".concat(this.id,\"__\"),A),this.userData={},this.timeStamp(\"\".concat(this.id,\" started\")),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[\"constructor\"],r=Object.getPrototypeOf(t),n=Object.getOwnPropertyNames(r),i=!0,o=!1,a=void 0;try{for(var u,s=function(){var r=u.value;\"function\"==typeof t[r]&&(e.find(function(t){return r===t})||(t[r]=t[r].bind(t)))},c=n[Symbol.iterator]();!(i=(u=c.next()).done);i=!0)s()}catch(t){o=!0,a=t}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}(this),Object.seal(this)}return Object(l.a)(t,[{key:\"isEnabled\",value:function(){return this._storage.config.enabled}},{key:\"getPriority\",value:function(){return this._storage.config.priority}},{key:\"getLevel\",value:function(){return this._storage.config.priority}},{key:\"getTotal\",value:function(){return Number((v()-this._startTs).toPrecision(10))}},{key:\"getDelta\",value:function(){return Number((v()-this._deltaTs).toPrecision(10))}},{key:\"enable\",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:t}),this}},{key:\"setLevel\",value:function(t){return this._storage.updateConfiguration({priority:t}),this}},{key:\"warn\",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return this._getLogFunction({message:t,args:r,method:_.warn,once:!0})}},{key:\"error\",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return this._getLogFunction({message:t,args:r,method:_.error})}},{key:\"deprecated\",value:function(t,e){return this.warn(\"`\".concat(t,\"` is deprecated and will be removed in a later version. Use `\").concat(e,\"` instead\"))}},{key:\"removed\",value:function(t,e){return this.error(\"`\".concat(t,\"` has been removed. Use `\").concat(e,\"` instead\"))}},{key:\"probe\",value:function(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:n,method:_.log,time:!0,once:!0})}},{key:\"log\",value:function(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:n,method:_.debug})}},{key:\"info\",value:function(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:n,method:console.info})}},{key:\"once\",value:function(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:n,method:_.debug||_.info,once:!0})}},{key:\"table\",value:function(t,e,r){if(e){var n=function(t){for(var e in t)for(var r in t[e])return r||\"untitled\";return\"empty\"}(e);return this._getLogFunction({priority:t,message:e,args:r&&[r],tag:n,method:console.table||T})}return T}},{key:\"image\",value:function(t){var e=t.priority,r=t.image,n=t.message,i=void 0===n?\"\":n,a=t.scale,u=void 0===a?1:a;return e>this.getPriority()?T:o?this._logImageInBrowser({image:r,message:i,scale:u}):this._logImageInNode({image:r,message:i,scale:u})}},{key:\"_logImageInNode\",value:function(t){var e=t.image,n=(t.message,t.scale),i=void 0===n?1:n,o=null;try{o=r(98)}catch(t){}return o?function(){return o(e,{fit:\"box\",width:\"\".concat(Math.round(80*i),\"%\")}).then(function(t){return console.log(t)})}:T}},{key:\"_logImageInBrowser\",value:function(t){var e=t.image,r=t.message,n=void 0===r?\"\":r,i=t.scale,o=void 0===i?1:i;if(\"string\"==typeof e){var a=new Image;return a.onload=function(){var t,e=g(a,n,o);(t=console).log.apply(t,Object(m.a)(e))},a.src=e,T}var u,s=e.nodeName||\"\";if(\"img\"===s.toLowerCase())return(u=console).log.apply(u,Object(m.a)(g(e,n,o))),T;if(\"canvas\"===s.toLowerCase()){var c=new Image;return c.onload=function(){var t;return(t=console).log.apply(t,Object(m.a)(g(c,n,o)))},c.src=e.toDataURL(),T}return T}},{key:\"time\",value:function(t,e){return this._getLogFunction({priority:t,message:e,method:console.time?console.time:console.info})}},{key:\"timeEnd\",value:function(t,e){return this._getLogFunction({priority:t,message:e,method:console.timeEnd?console.timeEnd:console.info})}},{key:\"timeStamp\",value:function(t,e){return this._getLogFunction({priority:t,message:e,method:console.timeStamp||T})}},{key:\"group\",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1},n=(r=this._normalizeArguments({priority:t,message:e,opts:r})).collapsed;return this._getLogFunction({priority:t,message:e,opts:r,method:(n?console.groupCollapsed:console.group)||console.info})}},{key:\"groupCollapsed\",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},r,{collapsed:!0}))}},{key:\"groupEnd\",value:function(t){return this._getLogFunction({priority:t,message:\"\",method:console.groupEnd||T})}},{key:\"withGroup\",value:function(t,e,r){var n=this._normalizeArguments({priority:t,message:e});this.group(n);try{r()}finally{this.groupEnd(n.message)}}},{key:\"trace\",value:function(){console.trace&&console.trace()}},{key:\"_shouldLog\",value:function(t){return 0===(t=this._normalizePriority(t))||this.isEnabled()&&this.getPriority()>=t}},{key:\"_getElapsedTime\",value:function(){var t=this.getTotal(),e=this.getDelta();return this._deltaTs=v(),{total:t,delta:e}}},{key:\"_getLogFunction\",value:function(t){if(this._shouldLog(t.priority)){var e=t.method;t=this._parseArguments(t),w(e);var r=t.message,n=t.tag||t.message;if(t.once){if(M[n])return T;M[n]=v()}return r=this._decorateMessage(r,t),e.bind.apply(e,[console,r].concat(Object(m.a)(t.args)))}return T}},{key:\"_parseArguments\",value:function(t){var e=this._normalizeArguments(t),r=this._getElapsedTime(),n=r.delta,i=r.total;return Object.assign(t,e,{delta:n,total:i})}},{key:\"_normalizePriority\",value:function(t){var e;switch(Object(p.a)(t)){case\"number\":e=t;break;case\"object\":e=t.priority||0;break;default:e=0}return w(Number.isFinite(e)&&e>=0),e}},{key:\"_normalizeArguments\",value:function(t){var e=t.priority,r=t.message,n=t.args,i=void 0===n?[]:n,o=t.opts,a={priority:this._normalizePriority(e),message:r,args:i};switch(Object(p.a)(e)){case\"string\":case\"function\":void 0!==r&&i.unshift(r),Object.assign(a,{message:e});break;case\"object\":Object.assign(a,e)}return\"function\"==typeof a.message&&(a.message=this._shouldLog(a.priority)?a.message():\"\"),w(\"string\"==typeof a.message||\"object\"===Object(p.a)(a.message)),Object.assign(a,o)}},{key:\"_decorateMessage\",value:function(t,e){if(\"string\"==typeof t){var r=\"\";if(e.time)r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,r=Math.max(e-t.length,0);return\"\".concat(\" \".repeat(r)).concat(t)}(y(this._getElapsedTime().total));t=e.time?\"\".concat(this.id,\": \").concat(r,\"  \").concat(t):\"\".concat(this.id,\": \").concat(t),n=t,i=e.color,a=e.background,o||\"string\"!=typeof n||(i&&(i=k(i),n=\"\x1B[\".concat(i,\"m\").concat(n,\"\x1B[39m\")),a&&(i=k(a),n=\"\x1B[\".concat(a+10,\"m\").concat(n,\"\x1B[49m\"))),t=n}var n,i,a;return t}},{key:\"priority\",set:function(t){return this._storage.updateConfiguration({priority:t}),this},get:function(){return this._storage.config.priority}}]),t}();O.VERSION=i;var S=null;function j(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&!S&&(S=a.a.log.bind(a.a),a.a.log=function(){(function(t){if(!I){var e=a.c.probe.markdown;I=a.b.createElement(e?\"pre\":\"div\")}var r=a.b.body.childNodes;a.b.body.insertBefore(I,r&&r[0]),\"string\"==typeof t&&(I.innerHTML+=\"\".concat(t,\"<br />\"))}).apply(void 0,arguments),S.apply(void 0,arguments)}),!t&&S&&(a.a.log=S,S=null)}var I=null;r.d(e,\"VERSION\",function(){return i}),r.d(e,\"self\",function(){return a.e}),r.d(e,\"window\",function(){return a.f}),r.d(e,\"global\",function(){return a.c}),r.d(e,\"document\",function(){return a.b}),r.d(e,\"process\",function(){return a.d}),r.d(e,\"console\",function(){return a.a}),r.d(e,\"isBrowser\",function(){return n.a}),r.d(e,\"isBrowserMainThread\",function(){return n.b}),r.d(e,\"getBrowser\",function(){return c}),r.d(e,\"isMobile\",function(){return s}),r.d(e,\"isElectron\",function(){return u.a}),r.d(e,\"assert\",function(){return f}),r.d(e,\"Stats\",function(){return d}),r.d(e,\"Log\",function(){return O}),r.d(e,\"COLOR\",function(){return E}),r.d(e,\"_enableDOMLogging\",function(){return j});e.default=new O({id:\"probe.gl\"})},,function(t,e,r){\"use strict\";(function(t){r.d(e,\"b\",function(){return a}),r.d(e,\"a\",function(){return u});r(69);var n=r(70),i=r(71);function o(t){return t instanceof ArrayBuffer?t:\"undefined\"!=typeof Blob&&t instanceof Blob?(e=t,new Promise(function(t,r){var n,i=new FileReader;i.onload=function(t){n=t.target.result},i.onloadend=function(e){return t(n)},i.onerror=r,i.readAsArrayBuffer(e)})):\"string\"==typeof t?(r=t,(new n.TextEncoder).encode(r).buffer):new Uint8Array(t).buffer;var e,r}function a(t){return new DataView(o(t))}function u(t,e,r){var n;if(t instanceof ArrayBuffer)n=new Uint8Array(t);else{var o=t.byteOffset,a=t.byteLength;n=new Uint8Array(t.buffer,o,a)}return e.set(n,r),r+Object(i.b)(n.byteLength)}}).call(this,r(90).Buffer)}]);";
var workerFarm = null;
export function getWorkerFarm() {
  return workerFarm;
} // Mainly for testing

export function destroyWorkerFarm() {
  if (workerFarm) {
    workerFarm.destroy();
    workerFarm = null;
  }
}
export function initializeWorkerFarm(_ref) {
  var worker = _ref.worker,
      _ref$maxConcurrency = _ref.maxConcurrency,
      maxConcurrency = _ref$maxConcurrency === void 0 ? 4 : _ref$maxConcurrency;

  if (!workerFarm) {
    var xvizConfig = _objectSpread({}, getXVIZConfig());

    delete xvizConfig.preProcessPrimitive;
    var workerURL;

    if (typeof worker === 'string') {
      // worker is an URL
      workerURL = worker;
    } else {
      // use default worker
      var blob = new Blob([streamDataWorker], {
        type: 'application/javascript'
      });
      workerURL = URL.createObjectURL(blob);
    }

    workerFarm = new WorkerFarm({
      workerURL: workerURL,
      maxConcurrency: maxConcurrency,
      initialMessage: {
        xvizConfig: xvizConfig
      }
    });
  }
}
export function updateWorkerXVIZVersion() {
  if (workerFarm) {
    var xvizConfig = _objectSpread({}, getXVIZConfig());

    delete xvizConfig.preProcessPrimitive;
    workerFarm.broadcast({
      xvizConfig: xvizConfig
    });
  }
} // Subscribe to XVIZConfig changes so we can
// update WebWorkers to adapt to XVIZ version changes

subscribeXVIZConfigChange(updateWorkerXVIZVersion);
//# sourceMappingURL=parse-stream-workerfarm.js.map