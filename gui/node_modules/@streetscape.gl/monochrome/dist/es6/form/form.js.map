{"version":3,"sources":["../../../src/form/form.js"],"names":["React","PureComponent","PropTypes","withTheme","ExpandedIcon","CollapsedIcon","Input","Container","Expander","SETTING_STYLES","position","Form","collapsed","settingName","newValue","props","onChange","toggleCollapsed","newCollapsedState","state","setState","_renderSetting","setting","value","isEnabled","level","theme","style","enabled","visible","children","isVisible","values","Boolean","input","title","_onChange","collapsible","expander","iconCollapsed","iconExpanded","_renderSettings","settings","opts","Object","keys","child","push","render","data","wrapper","object","isRequired","func"],"mappings":"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","sourcesContent":["import React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport {withTheme} from '../shared/theme';\nimport {ExpandedIcon, CollapsedIcon} from '../shared/icons';\n\nimport Input from './input';\nimport {Container, Expander} from './styled-components';\n\nconst SETTING_STYLES = {\n  position: 'relative'\n};\n\nclass Form extends PureComponent {\n  static propTypes = {\n    data: PropTypes.object.isRequired,\n    style: PropTypes.object,\n    values: PropTypes.object.isRequired,\n    onChange: PropTypes.func.isRequired\n  };\n\n  static defaultProps = {\n    style: {}\n  };\n\n  state = {\n    collapsed: {}\n  };\n\n  _onChange = (settingName, newValue) => {\n    this.props.onChange({\n      [settingName]: newValue\n    });\n  };\n\n  toggleCollapsed({settingName, collapsed}) {\n    const newCollapsedState = {...this.state.collapsed, [settingName]: !collapsed};\n    this.setState({collapsed: newCollapsedState});\n  }\n\n  /* eslint-disable complexity */\n  _renderSetting({settingName, setting, value, isEnabled = true, level}) {\n    const {theme, style} = this.props;\n    const {enabled = true, visible = true, children} = setting;\n    let isVisible;\n\n    if (typeof enabled === 'function') {\n      isEnabled = isEnabled && enabled(this.props.values);\n    } else {\n      isEnabled = isEnabled && Boolean(enabled);\n    }\n\n    if (typeof visible === 'function') {\n      isVisible = visible(this.props.values);\n    } else {\n      isVisible = Boolean(visible);\n    }\n\n    if (!isVisible) {\n      return null;\n    }\n\n    const collapsed =\n      typeof this.state.collapsed[settingName] !== 'undefined'\n        ? this.state.collapsed[settingName]\n        : false;\n\n    const input = (\n      <Input\n        key={settingName}\n        {...setting}\n        label={setting.title || settingName}\n        name={settingName}\n        value={value}\n        theme={theme}\n        style={style}\n        level={level}\n        isEnabled={isEnabled}\n        onChange={this._onChange}\n      />\n    );\n\n    if (!children) {\n      return input;\n    }\n\n    return (\n      <div key={settingName} style={SETTING_STYLES}>\n        {setting.collapsible && (\n          <Expander\n            theme={theme}\n            userStyle={style.expander}\n            onClick={() => this.toggleCollapsed({settingName, collapsed})}\n            isExpanded={!collapsed}\n          >\n            {collapsed\n              ? style.iconCollapsed || <CollapsedIcon />\n              : style.iconExpanded || <ExpandedIcon />}\n          </Expander>\n        )}\n        {input}\n        {!collapsed && this._renderSettings(children, {isEnabled, level: level + 1})}\n      </div>\n    );\n  }\n  /* eslint-enable complexity */\n\n  _renderSettings(settings, opts = {}) {\n    const {values} = this.props;\n    const children = [];\n    for (const settingName of Object.keys(settings)) {\n      const setting = settings[settingName];\n      const value = values[settingName];\n      const collapsed = this.state.collapsed[settingName];\n      const level = opts.level || 0;\n      const child = this._renderSetting({...opts, settingName, setting, value, collapsed, level});\n      children.push(child);\n    }\n    return children;\n  }\n\n  render() {\n    const {theme, style, data} = this.props;\n    return (\n      <Container theme={theme} userStyle={style.wrapper}>\n        {this._renderSettings(data)}\n      </Container>\n    );\n  }\n}\n\nexport default withTheme(Form);\n"],"file":"form.js"}