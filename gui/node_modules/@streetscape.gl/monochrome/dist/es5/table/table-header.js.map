{"version":3,"sources":["../../../src/table/table-header.js"],"names":["SORT","NONE","ASCEND","DESCEND","TableHeader","props","columns","state","map","col","colIndex","ref","_cells","width","clientWidth","onResize","index","sortType","sort","forEach","multiplier","sortFunc","row1","row2","data","onSort","forceUpdate","column","renderHeader","theme","userStyle","styleProps","isAscending","isDescending","icon","iconAscending","iconDescending","headerCell","defaultWidth","cell","_sortColumn","srcObject","columnIndex","_formatColumns","nextProps","setState","totalWeight","weights","weight","type","name","header","_renderColumn","_onResize","PureComponent","PropTypes","arrayOf","object","func"],"mappings":"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","sourcesContent":["import React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport AutoSizer from '../shared/autosizer';\n\nimport {HeaderContainer, HeaderCell, SortIcon} from './styled-components';\n\nconst SORT = {\n  NONE: 0,\n  ASCEND: 1,\n  DESCEND: 2\n};\n\nexport default class TableHeader extends PureComponent {\n  static propTypes = {\n    columns: PropTypes.arrayOf(PropTypes.object),\n    renderHeader: PropTypes.func,\n    onSort: PropTypes.func,\n    onResize: PropTypes.func\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      columns: this._formatColumns(props.columns)\n    };\n\n    this._cells = [];\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (this.props.columns !== nextProps.columns) {\n      this.setState({\n        columns: this._formatColumns(nextProps.columns)\n      });\n    }\n  }\n\n  _formatColumns(columns) {\n    let totalWeight = 0;\n    const weights = [];\n\n    columns.forEach((col, colIndex) => {\n      let weight = 1;\n      if (colIndex === 0) {\n        weight++;\n      }\n      if (col.type === 'string') {\n        weight++;\n      }\n      weights[colIndex] = weight;\n      totalWeight += weight;\n    });\n\n    return columns.map((col, colIndex) => ({\n      srcObject: col,\n      name: col.name,\n      type: col.type,\n      sort: SORT.NONE,\n      defaultWidth: `${(100 / totalWeight) * weights[colIndex]}%`\n    }));\n  }\n\n  _onResize = () => {\n    const {columns} = this.state;\n\n    columns.map((col, colIndex) => {\n      const ref = this._cells[colIndex];\n      if (ref) {\n        col.width = ref.clientWidth;\n      }\n    });\n\n    this.props.onResize(columns);\n  };\n\n  _sortColumn = index => {\n    const {columns} = this.state;\n    const sortType = columns[index].sort === SORT.ASCEND ? SORT.DESCEND : SORT.ASCEND;\n\n    columns.forEach((col, colIndex) => {\n      col.sort = colIndex === index ? sortType : SORT.NONE;\n    });\n\n    const multiplier = sortType === SORT.ASCEND ? 1 : -1;\n\n    const sortFunc = (row1, row2) => {\n      return row1.data[index] <= row2.data[index] ? -multiplier : multiplier;\n    };\n    this.props.onSort(sortFunc);\n\n    // Trigger rerender\n    this.forceUpdate();\n  };\n\n  _renderColumn = (column, colIndex) => {\n    const {renderHeader, theme, userStyle} = this.props;\n\n    const styleProps = {\n      theme,\n      isAscending: column.sort === SORT.ASCEND,\n      isDescending: column.sort === SORT.DESCEND\n    };\n\n    let icon = null;\n    if (styleProps.isAscending) {\n      icon = userStyle.iconAscending || '↑';\n    } else if (styleProps.isDescending) {\n      icon = userStyle.iconDescending || '↓';\n    }\n\n    return (\n      <HeaderCell\n        {...styleProps}\n        userStyle={userStyle.headerCell}\n        style={{width: column.defaultWidth}}\n        key={colIndex}\n        index={colIndex}\n        ref={cell => {\n          this._cells[colIndex] = cell;\n        }}\n        onClick={() => this._sortColumn(colIndex)}\n      >\n        {renderHeader({column: column.srcObject, columnIndex: colIndex})}\n        {icon && (\n          <SortIcon {...styleProps} userStyle={userStyle.sort}>\n            {icon}\n          </SortIcon>\n        )}\n      </HeaderCell>\n    );\n  };\n\n  render() {\n    const {theme, userStyle} = this.props;\n    const {columns} = this.state;\n\n    return (\n      <HeaderContainer theme={theme} userStyle={userStyle.header}>\n        {columns.map(this._renderColumn)}\n        <AutoSizer onResize={this._onResize} debounceTime={200} />\n      </HeaderContainer>\n    );\n  }\n}\n"],"file":"table-header.js"}