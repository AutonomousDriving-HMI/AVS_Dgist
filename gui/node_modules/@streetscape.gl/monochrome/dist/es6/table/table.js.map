{"version":3,"sources":["../../../src/table/table.js"],"names":["React","PureComponent","PropTypes","AutoSizer","List","CellMeasurer","CellMeasurerCache","withTheme","TableHeader","TableRow","WrapperComponent","TableBody","Table","constructor","props","columns","setState","_forceUpdate","sortFunc","rows","state","sort","_list","_cache","clearAll","recomputeRowHeights","key","parent","index","style","_renderRow","_formatRows","fixedWidth","UNSAFE_componentWillReceiveProps","nextProps","map","row","rowIndex","srcObject","data","children","id","String","renderCell","theme","userStyle","_renderBody","width","height","list","length","rowHeight","_renderRowMeasurer","render","renderHeader","wrapper","_onSort","_onHeaderResize","body","bind","oneOfType","string","number","object","array","func","column","name","value"],"mappings":"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","sourcesContent":["import React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport AutoSizer from 'react-virtualized/dist/commonjs/AutoSizer';\nimport List from 'react-virtualized/dist/commonjs/List';\nimport CellMeasurer, {CellMeasurerCache} from 'react-virtualized/dist/commonjs/CellMeasurer';\n\nimport {withTheme} from '../shared/theme';\n\nimport TableHeader from './table-header';\nimport TableRow from './table-row';\nimport {WrapperComponent, TableBody} from './styled-components';\n\nexport class Table extends PureComponent {\n  static propTypes = {\n    width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    height: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    style: PropTypes.object,\n    columns: PropTypes.array,\n    rows: PropTypes.array,\n    renderHeader: PropTypes.func,\n    renderCell: PropTypes.func\n  };\n\n  static defaultProps = {\n    width: '100%',\n    height: 400,\n    style: {},\n    rows: [],\n    renderHeader: ({column}) => column.name,\n    renderCell: ({value}) => (value === null ? null : String(value))\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      columns: null,\n      sortFunc: null,\n      rows: this._formatRows(props.rows)\n    };\n\n    this._cache = new CellMeasurerCache({fixedWidth: true});\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (this.props.rows !== nextProps.rows) {\n      this.setState({\n        rows: this._formatRows(nextProps.rows, this.state.sortFunc)\n      });\n      this._forceUpdate();\n    }\n  }\n\n  _formatRows(rows, sortFunc) {\n    rows = rows.map((row, rowIndex) => ({\n      srcObject: row,\n      data: row.data,\n      children: row.children,\n      id: String(rowIndex)\n    }));\n\n    if (sortFunc) {\n      rows.sort(sortFunc);\n    }\n\n    return rows;\n  }\n\n  _onHeaderResize = columns => {\n    this.setState({columns}, this._forceUpdate);\n  };\n\n  _onSort = sortFunc => {\n    const {rows} = this.state;\n\n    if (sortFunc) {\n      rows.sort(sortFunc);\n    }\n\n    this.setState({sortFunc});\n    this._forceUpdate();\n  };\n\n  _forceUpdate = () => {\n    if (this._list) {\n      this._cache.clearAll();\n      this._list.recomputeRowHeights();\n    }\n  };\n\n  _renderRow({key, index, style}) {\n    const {renderCell, theme, style: userStyle} = this.props;\n    const row = this.state.rows[index];\n\n    return (\n      <TableRow\n        key={key}\n        id={row.id}\n        index={index}\n        data={row}\n        style={style}\n        theme={theme}\n        userStyle={userStyle}\n        renderCell={renderCell}\n        columns={this.state.columns}\n      />\n    );\n  }\n\n  _renderRowMeasurer = ({key, parent, index, style}) => {\n    return (\n      <CellMeasurer cache={this._cache} parent={parent} key={key} rowIndex={index} collumnIndex={0}>\n        {() => this._renderRow({key, index, style})}\n      </CellMeasurer>\n    );\n  };\n\n  // AutoSizer is a pure component. By default child function is only called if dimensions change.\n  // Rebind this function every render to respond to state change\n  _renderBody({width, height}) {\n    const {columns, rows} = this.state;\n\n    if (!columns) {\n      return null;\n    }\n\n    return (\n      <List\n        ref={list => {\n          this._list = list;\n        }}\n        tabIndex={null}\n        height={height}\n        rowCount={rows.length}\n        rowHeight={this._cache.rowHeight}\n        rowRenderer={this._renderRowMeasurer}\n        width={width}\n      />\n    );\n  }\n\n  render() {\n    const {theme, width, height, style, columns, renderHeader} = this.props;\n\n    return (\n      <WrapperComponent style={{width, height}} theme={theme} userStyle={style.wrapper}>\n        <TableHeader\n          theme={theme}\n          userStyle={style}\n          columns={columns}\n          renderHeader={renderHeader}\n          onSort={this._onSort}\n          onResize={this._onHeaderResize}\n        />\n\n        <TableBody theme={theme} userStyle={style.body}>\n          <AutoSizer>{this._renderBody.bind(this)}</AutoSizer>\n        </TableBody>\n      </WrapperComponent>\n    );\n  }\n}\n\nexport default withTheme(Table);\n"],"file":"table.js"}