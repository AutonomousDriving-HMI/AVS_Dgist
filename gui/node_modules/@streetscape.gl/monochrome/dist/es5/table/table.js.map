{"version":3,"sources":["../../../src/table/table.js"],"names":["Table","props","columns","setState","_forceUpdate","sortFunc","rows","state","sort","_list","_cache","clearAll","recomputeRowHeights","key","parent","index","style","_renderRow","_formatRows","CellMeasurerCache","fixedWidth","nextProps","map","row","rowIndex","srcObject","data","children","id","String","renderCell","theme","userStyle","width","height","list","length","rowHeight","_renderRowMeasurer","renderHeader","wrapper","_onSort","_onHeaderResize","body","_renderBody","bind","PureComponent","PropTypes","oneOfType","string","number","object","array","func","column","name","value"],"mappings":"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","sourcesContent":["import React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport AutoSizer from 'react-virtualized/dist/commonjs/AutoSizer';\nimport List from 'react-virtualized/dist/commonjs/List';\nimport CellMeasurer, {CellMeasurerCache} from 'react-virtualized/dist/commonjs/CellMeasurer';\n\nimport {withTheme} from '../shared/theme';\n\nimport TableHeader from './table-header';\nimport TableRow from './table-row';\nimport {WrapperComponent, TableBody} from './styled-components';\n\nexport class Table extends PureComponent {\n  static propTypes = {\n    width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    height: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    style: PropTypes.object,\n    columns: PropTypes.array,\n    rows: PropTypes.array,\n    renderHeader: PropTypes.func,\n    renderCell: PropTypes.func\n  };\n\n  static defaultProps = {\n    width: '100%',\n    height: 400,\n    style: {},\n    rows: [],\n    renderHeader: ({column}) => column.name,\n    renderCell: ({value}) => (value === null ? null : String(value))\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      columns: null,\n      sortFunc: null,\n      rows: this._formatRows(props.rows)\n    };\n\n    this._cache = new CellMeasurerCache({fixedWidth: true});\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (this.props.rows !== nextProps.rows) {\n      this.setState({\n        rows: this._formatRows(nextProps.rows, this.state.sortFunc)\n      });\n      this._forceUpdate();\n    }\n  }\n\n  _formatRows(rows, sortFunc) {\n    rows = rows.map((row, rowIndex) => ({\n      srcObject: row,\n      data: row.data,\n      children: row.children,\n      id: String(rowIndex)\n    }));\n\n    if (sortFunc) {\n      rows.sort(sortFunc);\n    }\n\n    return rows;\n  }\n\n  _onHeaderResize = columns => {\n    this.setState({columns}, this._forceUpdate);\n  };\n\n  _onSort = sortFunc => {\n    const {rows} = this.state;\n\n    if (sortFunc) {\n      rows.sort(sortFunc);\n    }\n\n    this.setState({sortFunc});\n    this._forceUpdate();\n  };\n\n  _forceUpdate = () => {\n    if (this._list) {\n      this._cache.clearAll();\n      this._list.recomputeRowHeights();\n    }\n  };\n\n  _renderRow({key, index, style}) {\n    const {renderCell, theme, style: userStyle} = this.props;\n    const row = this.state.rows[index];\n\n    return (\n      <TableRow\n        key={key}\n        id={row.id}\n        index={index}\n        data={row}\n        style={style}\n        theme={theme}\n        userStyle={userStyle}\n        renderCell={renderCell}\n        columns={this.state.columns}\n      />\n    );\n  }\n\n  _renderRowMeasurer = ({key, parent, index, style}) => {\n    return (\n      <CellMeasurer cache={this._cache} parent={parent} key={key} rowIndex={index} collumnIndex={0}>\n        {() => this._renderRow({key, index, style})}\n      </CellMeasurer>\n    );\n  };\n\n  // AutoSizer is a pure component. By default child function is only called if dimensions change.\n  // Rebind this function every render to respond to state change\n  _renderBody({width, height}) {\n    const {columns, rows} = this.state;\n\n    if (!columns) {\n      return null;\n    }\n\n    return (\n      <List\n        ref={list => {\n          this._list = list;\n        }}\n        tabIndex={null}\n        height={height}\n        rowCount={rows.length}\n        rowHeight={this._cache.rowHeight}\n        rowRenderer={this._renderRowMeasurer}\n        width={width}\n      />\n    );\n  }\n\n  render() {\n    const {theme, width, height, style, columns, renderHeader} = this.props;\n\n    return (\n      <WrapperComponent style={{width, height}} theme={theme} userStyle={style.wrapper}>\n        <TableHeader\n          theme={theme}\n          userStyle={style}\n          columns={columns}\n          renderHeader={renderHeader}\n          onSort={this._onSort}\n          onResize={this._onHeaderResize}\n        />\n\n        <TableBody theme={theme} userStyle={style.body}>\n          <AutoSizer>{this._renderBody.bind(this)}</AutoSizer>\n        </TableBody>\n      </WrapperComponent>\n    );\n  }\n}\n\nexport default withTheme(Table);\n"],"file":"table.js"}