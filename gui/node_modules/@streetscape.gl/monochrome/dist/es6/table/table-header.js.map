{"version":3,"sources":["../../../src/table/table-header.js"],"names":["React","PureComponent","PropTypes","AutoSizer","HeaderContainer","HeaderCell","SortIcon","SORT","NONE","ASCEND","DESCEND","TableHeader","constructor","props","columns","state","map","col","colIndex","ref","_cells","width","clientWidth","onResize","index","sortType","sort","forEach","multiplier","sortFunc","row1","row2","data","onSort","forceUpdate","column","renderHeader","theme","userStyle","styleProps","isAscending","isDescending","icon","iconAscending","iconDescending","headerCell","defaultWidth","cell","_sortColumn","srcObject","columnIndex","_formatColumns","UNSAFE_componentWillReceiveProps","nextProps","setState","totalWeight","weights","weight","type","name","render","header","_renderColumn","_onResize","arrayOf","object","func"],"mappings":";;;;AAAA,OAAOA,KAAP,IAAeC,aAAf,QAAmC,OAAnC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AAEA,OAAOC,SAAP,MAAsB,qBAAtB;AAEA,SAAQC,eAAR,EAAyBC,UAAzB,EAAqCC,QAArC,QAAoD,qBAApD;AAEA,MAAMC,IAAI,GAAG;AACXC,EAAAA,IAAI,EAAE,CADK;AAEXC,EAAAA,MAAM,EAAE,CAFG;AAGXC,EAAAA,OAAO,EAAE;AAHE,CAAb;AAMA,eAAe,MAAMC,WAAN,SAA0BV,aAA1B,CAAwC;AAQrDW,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,uCA2CP,MAAM;AAAA,YACTC,OADS,GACE,KAAKC,KADP,CACTD,OADS;AAGhBA,MAAAA,OAAO,CAACE,GAAR,CAAY,CAACC,GAAD,EAAMC,QAAN,KAAmB;AAC7B,cAAMC,GAAG,GAAG,KAAKC,MAAL,CAAYF,QAAZ,CAAZ;;AACA,YAAIC,GAAJ,EAAS;AACPF,UAAAA,GAAG,CAACI,KAAJ,GAAYF,GAAG,CAACG,WAAhB;AACD;AACF,OALD;AAOA,WAAKT,KAAL,CAAWU,QAAX,CAAoBT,OAApB;AACD,KAtDkB;;AAAA,yCAwDLU,KAAK,IAAI;AAAA,YACdV,OADc,GACH,KAAKC,KADF,CACdD,OADc;AAErB,YAAMW,QAAQ,GAAGX,OAAO,CAACU,KAAD,CAAP,CAAeE,IAAf,KAAwBnB,IAAI,CAACE,MAA7B,GAAsCF,IAAI,CAACG,OAA3C,GAAqDH,IAAI,CAACE,MAA3E;AAEAK,MAAAA,OAAO,CAACa,OAAR,CAAgB,CAACV,GAAD,EAAMC,QAAN,KAAmB;AACjCD,QAAAA,GAAG,CAACS,IAAJ,GAAWR,QAAQ,KAAKM,KAAb,GAAqBC,QAArB,GAAgClB,IAAI,CAACC,IAAhD;AACD,OAFD;AAIA,YAAMoB,UAAU,GAAGH,QAAQ,KAAKlB,IAAI,CAACE,MAAlB,GAA2B,CAA3B,GAA+B,CAAC,CAAnD;;AAEA,YAAMoB,QAAQ,GAAG,CAACC,IAAD,EAAOC,IAAP,KAAgB;AAC/B,eAAOD,IAAI,CAACE,IAAL,CAAUR,KAAV,KAAoBO,IAAI,CAACC,IAAL,CAAUR,KAAV,CAApB,GAAuC,CAACI,UAAxC,GAAqDA,UAA5D;AACD,OAFD;;AAGA,WAAKf,KAAL,CAAWoB,MAAX,CAAkBJ,QAAlB,EAbqB,CAerB;;AACA,WAAKK,WAAL;AACD,KAzEkB;;AAAA,2CA2EH,CAACC,MAAD,EAASjB,QAAT,KAAsB;AAAA,0BACK,KAAKL,KADV;AAAA,YAC7BuB,YAD6B,eAC7BA,YAD6B;AAAA,YACfC,KADe,eACfA,KADe;AAAA,YACRC,SADQ,eACRA,SADQ;AAGpC,YAAMC,UAAU,GAAG;AACjBF,QAAAA,KADiB;AAEjBG,QAAAA,WAAW,EAAEL,MAAM,CAACT,IAAP,KAAgBnB,IAAI,CAACE,MAFjB;AAGjBgC,QAAAA,YAAY,EAAEN,MAAM,CAACT,IAAP,KAAgBnB,IAAI,CAACG;AAHlB,OAAnB;AAMA,UAAIgC,IAAI,GAAG,IAAX;;AACA,UAAIH,UAAU,CAACC,WAAf,EAA4B;AAC1BE,QAAAA,IAAI,GAAGJ,SAAS,CAACK,aAAV,IAA2B,GAAlC;AACD,OAFD,MAEO,IAAIJ,UAAU,CAACE,YAAf,EAA6B;AAClCC,QAAAA,IAAI,GAAGJ,SAAS,CAACM,cAAV,IAA4B,GAAnC;AACD;;AAED,aACE,oBAAC,UAAD,eACML,UADN;AAEE,QAAA,SAAS,EAAED,SAAS,CAACO,UAFvB;AAGE,QAAA,KAAK,EAAE;AAACxB,UAAAA,KAAK,EAAEc,MAAM,CAACW;AAAf,SAHT;AAIE,QAAA,GAAG,EAAE5B,QAJP;AAKE,QAAA,KAAK,EAAEA,QALT;AAME,QAAA,GAAG,EAAE6B,IAAI,IAAI;AACX,eAAK3B,MAAL,CAAYF,QAAZ,IAAwB6B,IAAxB;AACD,SARH;AASE,QAAA,OAAO,EAAE,MAAM,KAAKC,WAAL,CAAiB9B,QAAjB;AATjB,UAWGkB,YAAY,CAAC;AAACD,QAAAA,MAAM,EAAEA,MAAM,CAACc,SAAhB;AAA2BC,QAAAA,WAAW,EAAEhC;AAAxC,OAAD,CAXf,EAYGwB,IAAI,IACH,oBAAC,QAAD,eAAcH,UAAd;AAA0B,QAAA,SAAS,EAAED,SAAS,CAACZ;AAA/C,UACGgB,IADH,CAbJ,CADF;AAoBD,KA/GkB;;AAGjB,SAAK3B,KAAL,GAAa;AACXD,MAAAA,OAAO,EAAE,KAAKqC,cAAL,CAAoBtC,KAAK,CAACC,OAA1B;AADE,KAAb;AAIA,SAAKM,MAAL,GAAc,EAAd;AACD;;AAEDgC,EAAAA,gCAAgC,CAACC,SAAD,EAAY;AAC1C,QAAI,KAAKxC,KAAL,CAAWC,OAAX,KAAuBuC,SAAS,CAACvC,OAArC,EAA8C;AAC5C,WAAKwC,QAAL,CAAc;AACZxC,QAAAA,OAAO,EAAE,KAAKqC,cAAL,CAAoBE,SAAS,CAACvC,OAA9B;AADG,OAAd;AAGD;AACF;;AAEDqC,EAAAA,cAAc,CAACrC,OAAD,EAAU;AACtB,QAAIyC,WAAW,GAAG,CAAlB;AACA,UAAMC,OAAO,GAAG,EAAhB;AAEA1C,IAAAA,OAAO,CAACa,OAAR,CAAgB,CAACV,GAAD,EAAMC,QAAN,KAAmB;AACjC,UAAIuC,MAAM,GAAG,CAAb;;AACA,UAAIvC,QAAQ,KAAK,CAAjB,EAAoB;AAClBuC,QAAAA,MAAM;AACP;;AACD,UAAIxC,GAAG,CAACyC,IAAJ,KAAa,QAAjB,EAA2B;AACzBD,QAAAA,MAAM;AACP;;AACDD,MAAAA,OAAO,CAACtC,QAAD,CAAP,GAAoBuC,MAApB;AACAF,MAAAA,WAAW,IAAIE,MAAf;AACD,KAVD;AAYA,WAAO3C,OAAO,CAACE,GAAR,CAAY,CAACC,GAAD,EAAMC,QAAN,MAAoB;AACrC+B,MAAAA,SAAS,EAAEhC,GAD0B;AAErC0C,MAAAA,IAAI,EAAE1C,GAAG,CAAC0C,IAF2B;AAGrCD,MAAAA,IAAI,EAAEzC,GAAG,CAACyC,IAH2B;AAIrChC,MAAAA,IAAI,EAAEnB,IAAI,CAACC,IAJ0B;AAKrCsC,MAAAA,YAAY,EAAG,GAAG,MAAMS,WAAP,GAAsBC,OAAO,CAACtC,QAAD,CAAW;AALpB,KAApB,CAAZ,CAAP;AAOD;;AAwED0C,EAAAA,MAAM,GAAG;AAAA,yBACoB,KAAK/C,KADzB;AAAA,UACAwB,KADA,gBACAA,KADA;AAAA,UACOC,SADP,gBACOA,SADP;AAAA,UAEAxB,OAFA,GAEW,KAAKC,KAFhB,CAEAD,OAFA;AAIP,WACE,oBAAC,eAAD;AAAiB,MAAA,KAAK,EAAEuB,KAAxB;AAA+B,MAAA,SAAS,EAAEC,SAAS,CAACuB;AAApD,OACG/C,OAAO,CAACE,GAAR,CAAY,KAAK8C,aAAjB,CADH,EAEE,oBAAC,SAAD;AAAW,MAAA,QAAQ,EAAE,KAAKC,SAA1B;AAAqC,MAAA,YAAY,EAAE;AAAnD,MAFF,CADF;AAMD;;AAnIoD;;gBAAlCpD,W,eACA;AACjBG,EAAAA,OAAO,EAAEZ,SAAS,CAAC8D,OAAV,CAAkB9D,SAAS,CAAC+D,MAA5B,CADQ;AAEjB7B,EAAAA,YAAY,EAAElC,SAAS,CAACgE,IAFP;AAGjBjC,EAAAA,MAAM,EAAE/B,SAAS,CAACgE,IAHD;AAIjB3C,EAAAA,QAAQ,EAAErB,SAAS,CAACgE;AAJH,C","sourcesContent":["import React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport AutoSizer from '../shared/autosizer';\n\nimport {HeaderContainer, HeaderCell, SortIcon} from './styled-components';\n\nconst SORT = {\n  NONE: 0,\n  ASCEND: 1,\n  DESCEND: 2\n};\n\nexport default class TableHeader extends PureComponent {\n  static propTypes = {\n    columns: PropTypes.arrayOf(PropTypes.object),\n    renderHeader: PropTypes.func,\n    onSort: PropTypes.func,\n    onResize: PropTypes.func\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      columns: this._formatColumns(props.columns)\n    };\n\n    this._cells = [];\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (this.props.columns !== nextProps.columns) {\n      this.setState({\n        columns: this._formatColumns(nextProps.columns)\n      });\n    }\n  }\n\n  _formatColumns(columns) {\n    let totalWeight = 0;\n    const weights = [];\n\n    columns.forEach((col, colIndex) => {\n      let weight = 1;\n      if (colIndex === 0) {\n        weight++;\n      }\n      if (col.type === 'string') {\n        weight++;\n      }\n      weights[colIndex] = weight;\n      totalWeight += weight;\n    });\n\n    return columns.map((col, colIndex) => ({\n      srcObject: col,\n      name: col.name,\n      type: col.type,\n      sort: SORT.NONE,\n      defaultWidth: `${(100 / totalWeight) * weights[colIndex]}%`\n    }));\n  }\n\n  _onResize = () => {\n    const {columns} = this.state;\n\n    columns.map((col, colIndex) => {\n      const ref = this._cells[colIndex];\n      if (ref) {\n        col.width = ref.clientWidth;\n      }\n    });\n\n    this.props.onResize(columns);\n  };\n\n  _sortColumn = index => {\n    const {columns} = this.state;\n    const sortType = columns[index].sort === SORT.ASCEND ? SORT.DESCEND : SORT.ASCEND;\n\n    columns.forEach((col, colIndex) => {\n      col.sort = colIndex === index ? sortType : SORT.NONE;\n    });\n\n    const multiplier = sortType === SORT.ASCEND ? 1 : -1;\n\n    const sortFunc = (row1, row2) => {\n      return row1.data[index] <= row2.data[index] ? -multiplier : multiplier;\n    };\n    this.props.onSort(sortFunc);\n\n    // Trigger rerender\n    this.forceUpdate();\n  };\n\n  _renderColumn = (column, colIndex) => {\n    const {renderHeader, theme, userStyle} = this.props;\n\n    const styleProps = {\n      theme,\n      isAscending: column.sort === SORT.ASCEND,\n      isDescending: column.sort === SORT.DESCEND\n    };\n\n    let icon = null;\n    if (styleProps.isAscending) {\n      icon = userStyle.iconAscending || '↑';\n    } else if (styleProps.isDescending) {\n      icon = userStyle.iconDescending || '↓';\n    }\n\n    return (\n      <HeaderCell\n        {...styleProps}\n        userStyle={userStyle.headerCell}\n        style={{width: column.defaultWidth}}\n        key={colIndex}\n        index={colIndex}\n        ref={cell => {\n          this._cells[colIndex] = cell;\n        }}\n        onClick={() => this._sortColumn(colIndex)}\n      >\n        {renderHeader({column: column.srcObject, columnIndex: colIndex})}\n        {icon && (\n          <SortIcon {...styleProps} userStyle={userStyle.sort}>\n            {icon}\n          </SortIcon>\n        )}\n      </HeaderCell>\n    );\n  };\n\n  render() {\n    const {theme, userStyle} = this.props;\n    const {columns} = this.state;\n\n    return (\n      <HeaderContainer theme={theme} userStyle={userStyle.header}>\n        {columns.map(this._renderColumn)}\n        <AutoSizer onResize={this._onResize} debounceTime={200} />\n      </HeaderContainer>\n    );\n  }\n}\n"],"file":"table-header.js"}